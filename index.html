<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <meta name="description" content="AOSE Clothing | Premium Stitch & Wear - Timeless Elegance in Fashion">
    <meta name="keywords" content="premium clothing, fashion, luxury wear, AOSE, shirts, formal wear">
    <title>AOSE | Timeless Elegance</title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,600;0,700;1,400&family=Montserrat:wght@300;400;500;600&display=swap" rel="stylesheet">
    
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <!-- Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

    <style>
        /* ===== CSS OPTIMIZATIONS ===== */
        :root {
            --primary: #0f3d2e;        /* Deep Emerald */
            --primary-dark: #09251c;
            --primary-light: #1d5a45;
            --gold: #c6a664;           /* Muted Gold */
            --gold-light: #e0c88b;
            --gold-dark: #b59452;
            --cream: #f9f7f2;          /* Paper White */
            --white: #ffffff;
            --text-dark: #1a1a1a;
            --text-gray: #666666;
            --light-gray: #e9e9e9;
            --border: rgba(0,0,0,0.08);
            --shadow-soft: 0 10px 40px rgba(0,0,0,0.05);
            --shadow-medium: 0 15px 50px rgba(0,0,0,0.08);
            --shadow-hover: 0 20px 50px rgba(15, 61, 46, 0.15);
            --transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);
            --transition-fast: all 0.25s ease;
            --radius: 4px;
            --radius-lg: 8px;
        }

        /* Reset & Base */
        * { 
            margin: 0; 
            padding: 0; 
            box-sizing: border-box; 
            -webkit-tap-highlight-color: transparent;
        }
        html { 
            scroll-behavior: smooth;
            font-size: 16px;
        }
        body { 
            font-family: 'Montserrat', sans-serif; 
            background-color: var(--cream); 
            color: var(--text-dark); 
            line-height: 1.6;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* Typography */
        h1, h2, h3, h4, h5, h6 { 
            font-family: 'Cormorant Garamond', serif; 
            font-weight: 700; 
            color: var(--primary);
            line-height: 1.2;
        }
        p { margin-bottom: 1rem; }
        a { 
            text-decoration: none; 
            color: inherit;
            transition: var(--transition-fast);
        }
        button, .btn, input, select, textarea { 
            font-family: 'Montserrat', sans-serif; 
            font-size: 1rem;
        }
        button { cursor: pointer; }
        img { 
            display: block; 
            max-width: 100%; 
            height: auto;
        }

        /* Utility Classes */
        .text-center { text-align: center; }
        .text-gold { color: var(--gold); }
        .text-primary { color: var(--primary); }
        .mb-1 { margin-bottom: 0.5rem; }
        .mb-2 { margin-bottom: 1rem; }
        .mb-3 { margin-bottom: 1.5rem; }
        .mb-4 { margin-bottom: 2rem; }
        .mt-4 { margin-top: 2rem; }
        .hidden { display: none !important; }
        .visible { opacity: 1 !important; transform: none !important; }

        /* Loading Spinner */
        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--cream);
            border-top: 3px solid var(--gold);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Animations */
        .fade-up { 
            opacity: 0; 
            transform: translateY(30px); 
            transition: opacity 0.8s ease-out, transform 0.8s ease-out;
        }
        .fade-in { 
            opacity: 0; 
            transform: translateY(20px); 
            transition: opacity 0.5s ease-out, transform 0.5s ease-out;
        }
        .scale-up { 
            opacity: 0; 
            transform: scale(0.95); 
            transition: opacity 0.5s ease-out, transform 0.5s ease-out;
        }

        /* ===== HEADER ===== */
        header {
            position: sticky; 
            top: 0; 
            z-index: 1000;
            background: rgba(249, 247, 242, 0.95);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border-bottom: 1px solid rgba(198, 166, 100, 0.2);
            padding: 12px 5%;
            transition: var(--transition);
            box-shadow: 0 2px 20px rgba(0,0,0,0.03);
        }
        header.scrolled {
            padding: 8px 5%;
            box-shadow: 0 5px 25px rgba(0,0,0,0.08);
        }
        .nav-container { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            max-width: 1400px; 
            margin: 0 auto; 
        }
        
        /* Logo */
        .logo { 
            display: flex; 
            align-items: center; 
            gap: 12px; 
            text-decoration: none;
        }
        .logo-img { 
            height: 48px; 
            width: 48px;
            border-radius: var(--radius);
            object-fit: cover;
            border: 1px solid rgba(198, 166, 100, 0.2);
        }
        .logo-text { 
            font-family: 'Cormorant Garamond', serif; 
            font-size: 1.8rem; 
            color: var(--primary); 
            letter-spacing: 0.5px; 
            font-weight: 700;
            line-height: 1;
        }

        /* Navigation Icons */
        .nav-icons { 
            display: flex; 
            gap: 18px; 
            align-items: center; 
        }
        .icon-btn { 
            background: none; 
            border: none;
            font-size: 1.3rem; 
            color: var(--primary); 
            position: relative; 
            transition: var(--transition-fast);
            padding: 8px;
            border-radius: 50%;
            width: 44px;
            height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .icon-btn:hover { 
            color: var(--gold); 
            background: rgba(15, 61, 46, 0.05);
            transform: translateY(-2px); 
        }
        .badge {
            position: absolute; 
            top: -2px; 
            right: -2px;
            background: var(--gold); 
            color: white;
            font-size: 10px; 
            font-weight: 700;
            width: 18px; 
            height: 18px; 
            border-radius: 50%;
            display: flex; 
            align-items: center; 
            justify-content: center;
            border: 2px solid var(--cream);
        }

        /* ===== HERO SECTION ===== */
        .hero {
            position: relative; 
            height: 90vh;
            min-height: 600px;
            max-height: 800px;
            background: linear-gradient(rgba(15, 61, 46, 0.7), rgba(15, 61, 46, 0.3)), 
                        url('pro17.jpg') center/cover no-repeat;
            display: flex; 
            align-items: center; 
            justify-content: center;
            text-align: center; 
            color: white;
            overflow: hidden;
        }
        .hero-content { 
            position: relative; 
            z-index: 2; 
            max-width: 900px; 
            padding: 30px; 
            width: 90%;
        }
        .hero-subtitle { 
            font-size: 0.95rem; 
            letter-spacing: 3px; 
            text-transform: uppercase; 
            color: var(--gold); 
            margin-bottom: 20px; 
            display: block; 
            opacity: 0;
            animation: fadeInUp 1s ease 0.2s forwards;
            font-weight: 500;
        }
        .hero h1 { 
            font-size: clamp(3rem, 7vw, 4.5rem); 
            line-height: 1.1; 
            margin-bottom: 30px; 
            color: white; 
            text-shadow: 0 5px 15px rgba(0,0,0,0.3); 
            opacity: 0;
            animation: fadeInUp 1s ease 0.4s forwards;
        }
        .hero p {
            font-size: 1.2rem;
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto 30px;
            opacity: 0;
            animation: fadeInUp 1s ease 0.6s forwards;
        }

        @keyframes fadeInUp { 
            from { 
                opacity: 0; 
                transform: translateY(30px); 
            } 
            to { 
                opacity: 1; 
                transform: translateY(0); 
            } 
        }

        /* Buttons */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 16px 40px;
            font-size: 0.9rem;
            font-weight: 600;
            letter-spacing: 1px;
            text-transform: uppercase;
            border-radius: 50px;
            transition: var(--transition);
            cursor: pointer;
            border: none;
            outline: none;
            text-align: center;
            white-space: nowrap;
            line-height: 1;
        }
        .btn-gold {
            background: var(--gold); 
            color: white;
            box-shadow: 0 10px 30px rgba(198, 166, 100, 0.3);
            opacity: 0;
            animation: fadeInUp 1s ease 0.8s forwards;
        }
        .btn-gold:hover { 
            background: white; 
            color: var(--primary); 
            transform: translateY(-3px); 
            box-shadow: 0 15px 40px rgba(198, 166, 100, 0.4);
        }
        .btn-outline {
            background: transparent;
            color: var(--primary);
            border: 2px solid var(--primary);
        }
        .btn-outline:hover {
            background: var(--primary);
            color: white;
            transform: translateY(-2px);
        }
        .btn-small {
            padding: 10px 25px;
            font-size: 0.85rem;
        }
        .btn-full { 
            width: 100%; 
            padding: 16px; 
            background: var(--primary); 
            color: white; 
            font-weight: 600; 
            letter-spacing: 1px; 
            border-radius: var(--radius); 
            transition: var(--transition-fast); 
            border: none;
        }
        .btn-full:hover { 
            background: var(--gold); 
            transform: translateY(-2px);
        }

        /* ===== SECTIONS ===== */
        .section {
            padding: 80px 20px;
        }
        .container { 
            max-width: 1400px; 
            margin: 0 auto; 
            padding: 0 20px;
            width: 100%;
        }
        .section-header { 
            text-align: center; 
            margin-bottom: 60px; 
        }
        .section-header h2 { 
            font-size: 2.8rem; 
            margin-bottom: 15px;
            position: relative;
            display: inline-block;
        }
        .section-header h2::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 2px;
            background: var(--gold);
        }
        .section-header p { 
            color: var(--text-gray); 
            font-style: italic; 
            font-family: 'Cormorant Garamond', serif; 
            font-size: 1.3rem;
            max-width: 600px;
            margin: 0 auto;
        }

        /* ===== SIZE CHART SECTION ===== */
        .size-chart-section {
            background: linear-gradient(135deg, rgba(15, 61, 46, 0.05) 0%, rgba(198, 166, 100, 0.05) 100%);
            position: relative;
            overflow: hidden;
        }

        .size-chart-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 30%, rgba(198, 166, 100, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(15, 61, 46, 0.1) 0%, transparent 50%);
            pointer-events: none;
        }

        .size-chart-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 60px;
            align-items: center;
            position: relative;
            z-index: 1;
        }

        @media (max-width: 992px) {
            .size-chart-container {
                grid-template-columns: 1fr;
                gap: 40px;
            }
        }

        .size-chart-info {
            padding-right: 30px;
        }

        .size-chart-info h3 {
            font-size: 2rem;
            margin-bottom: 20px;
            color: var(--primary);
        }

        .size-chart-info p {
            color: var(--text-gray);
            margin-bottom: 30px;
            line-height: 1.8;
        }

        .size-chart-graphic {
            position: relative;
            perspective: 1000px;
        }

        .chart-table-container {
            background: white;
            border-radius: var(--radius-lg);
            padding: 40px;
            box-shadow: var(--shadow-hover);
            transform-style: preserve-3d;
            animation: float 6s ease-in-out infinite;
            position: relative;
            overflow: hidden;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0) rotateX(5deg) rotateY(5deg); }
            50% { transform: translateY(-20px) rotateX(-5deg) rotateY(-5deg); }
        }

        .chart-table-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--gold), var(--primary));
        }

        .size-chart-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 1rem;
            transform: translateZ(30px);
        }

        .size-chart-table thead {
            background: linear-gradient(to right, var(--primary), var(--primary-dark));
            color: white;
        }

        .size-chart-table th {
            padding: 20px 15px;
            text-align: center;
            font-weight: 600;
            font-family: 'Montserrat', sans-serif;
            font-size: 1.1rem;
            border-right: 1px solid rgba(255,255,255,0.1);
            position: relative;
            overflow: hidden;
        }

        .size-chart-table th:last-child {
            border-right: none;
        }

        .size-chart-table th::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            transform: translate(-50%, -50%) scaleX(0);
            animation: shimmer 3s infinite;
        }

        @keyframes shimmer {
            0% { transform: translate(-50%, -50%) scaleX(0); }
            50% { transform: translate(-50%, -50%) scaleX(1); }
            100% { transform: translate(-50%, -50%) scaleX(0); }
        }

        .size-chart-table td {
            padding: 18px 15px;
            text-align: center;
            border: 1px solid var(--border);
            transition: all 0.3s ease;
            position: relative;
        }

        .size-chart-table tbody tr {
            transition: all 0.3s ease;
            background: white;
        }

        .size-chart-table tbody tr:hover {
            background: rgba(15, 61, 46, 0.03);
            transform: translateX(5px);
        }

        .size-chart-table tbody tr:hover td {
            color: var(--primary);
            border-color: var(--gold-light);
        }

        .size-chart-table tbody tr:nth-child(even) {
            background: rgba(249, 247, 242, 0.5);
        }

        .size-chart-table tbody tr:nth-child(even):hover {
            background: rgba(15, 61, 46, 0.05);
        }

        .measurement-highlight {
            color: var(--gold);
            font-weight: 600;
            position: relative;
        }

        .measurement-highlight::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 50%;
            transform: translateX(-50%);
            width: 30px;
            height: 2px;
            background: var(--gold);
            transition: width 0.3s ease;
        }

        .size-chart-table tr:hover .measurement-highlight::after {
            width: 50px;
        }

        .size-illustration {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 40px;
        }

        .shirt-diagram {
            width: 300px;
            height: 400px;
            position: relative;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 300"><path fill="%23f9f7f2" stroke="%23c6a664" stroke-width="2" d="M50,50 Q100,20 150,50 L180,150 Q200,200 150,250 L50,250 Q0,200 20,150 Z"/></svg>') no-repeat center;
            background-size: contain;
        }

        .measurement-line {
            position: absolute;
            background: var(--gold);
            transform-origin: left center;
        }

        .measurement-label {
            position: absolute;
            background: var(--primary);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 600;
            white-space: nowrap;
        }

        .size-tips {
            background: white;
            border-radius: var(--radius-lg);
            padding: 30px;
            margin-top: 40px;
            box-shadow: var(--shadow-soft);
            border-left: 4px solid var(--gold);
        }

        .size-tips h4 {
            color: var(--primary);
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .size-tips ul {
            list-style: none;
            padding-left: 20px;
        }

        .size-tips li {
            margin-bottom: 10px;
            position: relative;
            padding-left: 25px;
        }

        .size-tips li::before {
            content: 'âœ“';
            position: absolute;
            left: 0;
            color: var(--gold);
            font-weight: bold;
        }

        /* ===== AR TRY-ON SECTION ===== */
        .ar-tryon-section {
            background: linear-gradient(135deg, var(--primary-dark) 0%, var(--primary) 100%);
            color: white;
            position: relative;
            overflow: hidden;
        }

        .ar-tryon-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 10% 20%, rgba(255,255,255,0.1) 0%, transparent 50%),
                radial-gradient(circle at 90% 80%, rgba(198, 166, 100, 0.2) 0%, transparent 50%);
            pointer-events: none;
        }

        .ar-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .ar-header {
            text-align: center;
            margin-bottom: 50px;
            position: relative;
            z-index: 1;
        }

        .ar-header h2 {
            color: white;
            font-size: 3rem;
            margin-bottom: 15px;
        }

        .ar-header p {
            font-size: 1.2rem;
            opacity: 0.9;
            max-width: 700px;
            margin: 0 auto;
        }

        .ar-features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            margin-bottom: 50px;
        }

        .ar-feature {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: var(--radius-lg);
            padding: 30px;
            text-align: center;
            transition: transform 0.3s ease;
        }

        .ar-feature:hover {
            transform: translateY(-10px);
            background: rgba(255, 255, 255, 0.15);
        }

        .ar-feature i {
            font-size: 2.5rem;
            color: var(--gold);
            margin-bottom: 20px;
        }

        .ar-feature h3 {
            color: white;
            margin-bottom: 15px;
            font-size: 1.5rem;
        }

        .ar-main {
            background: rgba(0, 0, 0, 0.3);
            border-radius: var(--radius-lg);
            padding: 40px;
            backdrop-filter: blur(10px);
            margin-bottom: 40px;
        }

        .ar-controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }

        @media (max-width: 768px) {
            .ar-controls {
                grid-template-columns: 1fr;
            }
        }

        .ar-product-selector {
            background: rgba(255, 255, 255, 0.1);
            border-radius: var(--radius);
            padding: 25px;
        }

        .ar-product-selector h3 {
            color: white;
            margin-bottom: 20px;
            font-size: 1.3rem;
        }

        .ar-products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 15px;
        }

        .ar-product-thumb {
            cursor: pointer;
            border-radius: var(--radius);
            overflow: hidden;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .ar-product-thumb:hover {
            transform: scale(1.05);
            border-color: var(--gold);
        }

        .ar-product-thumb.active {
            border-color: var(--gold);
            box-shadow: 0 0 20px rgba(198, 166, 100, 0.5);
        }

        .ar-product-thumb img {
            width: 100%;
            height: 120px;
            object-fit: cover;
        }

        .ar-camera-container {
            background: rgba(0, 0, 0, 0.5);
            border-radius: var(--radius);
            padding: 25px;
        }

        .ar-camera-container h3 {
            color: white;
            margin-bottom: 20px;
            font-size: 1.3rem;
        }

        .ar-preview {
            position: relative;
            width: 100%;
            height: 400px;
            background: #000;
            border-radius: var(--radius);
            overflow: hidden;
            margin-bottom: 20px;
        }

        #arVideo {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: none;
        }

        #arCanvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        .ar-overlay-controls {
            position: absolute;
            bottom: 20px;
            left: 0;
            right: 0;
            display: flex;
            justify-content: center;
            gap: 15px;
            z-index: 10;
        }

        .ar-overlay-controls button {
            background: rgba(0, 0, 0, 0.7);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 50px;
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .ar-overlay-controls button:hover {
            background: var(--gold);
            transform: translateY(-2px);
        }

        .ar-control-buttons {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .ar-control-buttons button {
            flex: 1;
            min-width: 150px;
        }

        .ar-instructions {
            background: rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-lg);
            padding: 30px;
            margin-top: 40px;
        }

        .ar-instructions h3 {
            color: white;
            margin-bottom: 20px;
            font-size: 1.5rem;
            text-align: center;
        }

        .ar-steps {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 30px;
            counter-reset: step-counter;
        }

        .ar-step {
            text-align: center;
            position: relative;
            padding-top: 60px;
        }

        .ar-step::before {
            counter-increment: step-counter;
            content: counter(step-counter);
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 50px;
            height: 50px;
            background: var(--gold);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary);
        }

        .ar-step h4 {
            color: white;
            margin-bottom: 10px;
            font-size: 1.2rem;
        }

        .ar-step p {
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.95rem;
        }

        .ar-fit-guide {
            background: white;
            border-radius: var(--radius-lg);
            padding: 40px;
            margin-top: 60px;
            box-shadow: var(--shadow-hover);
        }

        .ar-fit-guide h3 {
            color: var(--primary);
            text-align: center;
            margin-bottom: 30px;
            font-size: 2rem;
        }

        .fit-indicators {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
        }

        .fit-indicator {
            text-align: center;
            padding: 25px;
            border-radius: var(--radius);
            background: var(--cream);
            transition: transform 0.3s ease;
        }

        .fit-indicator:hover {
            transform: translateY(-5px);
        }

        .fit-indicator i {
            font-size: 2.5rem;
            color: var(--gold);
            margin-bottom: 15px;
        }

        .fit-indicator.good i { color: #27ae60; }
        .fit-indicator.warning i { color: #f39c12; }
        .fit-indicator.bad i { color: #e74c3c; }

        .fit-indicator h4 {
            color: var(--primary);
            margin-bottom: 10px;
        }

        /* ===== PRODUCT GRID ===== */
        .products-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 20px;
        }
        .filter-controls {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        .filter-select {
            padding: 10px 20px;
            border: 1px solid var(--border);
            border-radius: var(--radius);
            background: white;
            font-family: 'Montserrat', sans-serif;
            color: var(--text-dark);
            cursor: pointer;
            transition: var(--transition-fast);
        }
        .filter-select:focus {
            outline: none;
            border-color: var(--gold);
            box-shadow: 0 0 0 2px rgba(198, 166, 100, 0.1);
        }

        .grid {
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 30px;
        }
        .card {
            background: white; 
            border-radius: var(--radius-lg); 
            overflow: hidden;
            box-shadow: var(--shadow-soft); 
            transition: var(--transition);
            position: relative;
            height: 100%;
            display: flex;
            flex-direction: column;
        }
        .card:hover { 
            transform: translateY(-10px); 
            box-shadow: var(--shadow-hover); 
        }
        
        .card-img-wrap { 
            position: relative; 
            height: 380px; 
            overflow: hidden; 
            background: #f5f5f5;
        }
        .card-img { 
            width: 100%; 
            height: 100%; 
            object-fit: cover; 
            transition: transform 0.7s ease; 
        }
        .card:hover .card-img { 
            transform: scale(1.05); 
        }

        /* Product Labels */
        .product-label {
            position: absolute;
            top: 15px;
            left: 15px;
            background: var(--gold);
            color: white;
            padding: 4px 12px;
            font-size: 0.75rem;
            font-weight: 600;
            letter-spacing: 0.5px;
            border-radius: 20px;
            z-index: 2;
        }
        .label-new { background: var(--primary); }
        .label-sale { background: #d9534f; }

        /* Wishlist Button */
        .wishlist-btn {
            position: absolute; 
            top: 15px; 
            right: 15px;
            width: 40px; 
            height: 40px; 
            background: rgba(255, 255, 255, 0.9); 
            border-radius: 50%;
            display: flex; 
            align-items: center; 
            justify-content: center;
            color: var(--text-dark); 
            cursor: pointer; 
            transition: var(--transition-fast);
            z-index: 5; 
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border: none;
            outline: none;
        }
        .wishlist-btn:hover { 
            background: white; 
            transform: scale(1.1); 
            color: #ff4757;
        }
        .wishlist-btn.active { 
            background: #ff4757; 
            color: white; 
        }
        .wishlist-btn.active:hover { 
            background: #ff3742; 
        }

        .card-body { 
            padding: 25px; 
            text-align: center; 
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }
        .card-title { 
            font-size: 1.1rem; 
            font-weight: 600; 
            font-family: 'Montserrat', sans-serif; 
            margin-bottom: 8px; 
            color: var(--text-dark);
        }
        .card-price { 
            color: var(--gold); 
            font-weight: 700; 
            font-size: 1.2rem; 
            margin-bottom: 20px; 
            display: block;
        }
        .card-price .old-price {
            color: var(--text-gray);
            text-decoration: line-through;
            font-size: 0.9rem;
            font-weight: 400;
            margin-left: 8px;
        }
        
        /* Size Selector */
        .size-row { 
            display: flex; 
            justify-content: center; 
            gap: 8px; 
            margin-bottom: 20px; 
            flex-wrap: wrap; 
        }
        .size-opt {
            width: 36px; 
            height: 36px; 
            border: 1px solid var(--light-gray);
            display: flex; 
            align-items: center; 
            justify-content: center;
            font-size: 0.8rem; 
            font-weight: 600;
            border-radius: 50%; 
            cursor: pointer; 
            transition: var(--transition-fast);
            background: white;
        }
        .size-opt:hover { 
            border-color: var(--primary); 
            color: var(--primary); 
            transform: translateY(-2px);
        }
        .size-opt.selected { 
            background: var(--primary); 
            color: white; 
            border-color: var(--primary);
            box-shadow: 0 4px 12px rgba(15, 61, 46, 0.2);
        }
        .size-opt.disabled {
            opacity: 0.4;
            cursor: not-allowed;
            background: #f8f8f8;
        }

        .btn-add {
            width: 100%; 
            padding: 14px; 
            background: var(--primary); 
            color: white;
            font-weight: 600; 
            text-transform: uppercase; 
            font-size: 0.85rem; 
            letter-spacing: 1px;
            transition: var(--transition-fast); 
            border-radius: var(--radius);
            border: none;
            margin-top: auto;
        }
        .btn-add:hover { 
            background: var(--gold); 
            transform: translateY(-2px);
        }
        .btn-add:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        /* ===== MODALS & DRAWERS ===== */
        .overlay {
            position: fixed; 
            inset: 0; 
            background: rgba(0,0,0,0.6); 
            z-index: 2000;
            opacity: 0; 
            visibility: hidden; 
            transition: 0.3s; 
            backdrop-filter: blur(4px);
        }
        .overlay.active { 
            opacity: 1; 
            visibility: visible; 
        }

        /* Drawer */
        .drawer {
            position: fixed; 
            top: 0; 
            right: -100%; 
            width: 100%; 
            max-width: 420px; 
            height: 100%;
            background: white; 
            z-index: 2001; 
            transition: 0.4s cubic-bezier(0.2, 0.8, 0.2, 1);
            display: flex; 
            flex-direction: column; 
            box-shadow: -10px 0 40px rgba(0,0,0,0.15);
        }
        .drawer.active { 
            right: 0; 
        }

        .drawer-header { 
            padding: 25px; 
            border-bottom: 1px solid var(--border); 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            background: #fff; 
        }
        .drawer-body { 
            flex: 1; 
            overflow-y: auto; 
            padding: 25px; 
            background: var(--cream); 
        }
        .drawer-footer { 
            padding: 25px; 
            background: white; 
            border-top: 1px solid var(--border); 
            box-shadow: 0 -2px 10px rgba(0,0,0,0.03);
        }

        /* Cart Item */
        .cart-item { 
            display: flex; 
            gap: 15px; 
            margin-bottom: 20px; 
            padding-bottom: 20px; 
            border-bottom: 1px solid rgba(0,0,0,0.05); 
            align-items: flex-start;
        }
        .cart-img { 
            width: 80px; 
            height: 100px; 
            object-fit: cover; 
            border-radius: var(--radius); 
            flex-shrink: 0;
        }
        .cart-item-details {
            flex: 1;
            min-width: 0;
        }
        .cart-item-title {
            font-weight: 600;
            margin-bottom: 5px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .cart-item-size {
            font-size: 0.85rem;
            color: var(--text-gray);
            margin-bottom: 8px;
        }
        .cart-item-price {
            color: var(--gold);
            font-weight: 700;
            font-size: 1rem;
        }
        .qty-box { 
            display: flex; 
            align-items: center; 
            border: 1px solid #ddd; 
            width: max-content; 
            margin-top: 10px; 
            border-radius: var(--radius); 
            overflow: hidden; 
            background: white;
        }
        .qty-btn { 
            padding: 6px 12px; 
            background: white; 
            font-size: 0.9rem; 
            transition: 0.2s; 
            border: none;
            cursor: pointer;
            color: var(--text-dark);
        }
        .qty-btn:hover { 
            background: #f0f0f0; 
        }
        .qty-value {
            padding: 6px 15px;
            font-weight: 600;
            min-width: 40px;
            text-align: center;
            border-left: 1px solid #eee;
            border-right: 1px solid #eee;
        }
        .remove-item {
            background: none;
            border: none;
            color: #ff6b6b;
            cursor: pointer;
            padding: 8px;
            font-size: 1rem;
            transition: var(--transition-fast);
            margin-left: 10px;
        }
        .remove-item:hover {
            color: #ff4757;
            transform: scale(1.1);
        }

        /* Modal */
        .modal {
            position: fixed; 
            top: 50%; 
            left: 50%; 
            transform: translate(-50%, -50%) scale(0.9);
            background: white; 
            width: 90%; 
            max-width: 550px; 
            padding: 40px; 
            border-radius: var(--radius-lg);
            z-index: 2002; 
            opacity: 0; 
            visibility: hidden; 
            transition: 0.3s;
            max-height: 90vh; 
            overflow-y: auto; 
            box-shadow: 0 25px 50px rgba(0,0,0,0.2);
        }
        .modal.active { 
            opacity: 1; 
            visibility: visible; 
            transform: translate(-50%, -50%) scale(1); 
        }
        .modal-close {
            position: absolute; 
            top: 20px; 
            right: 20px; 
            font-size: 1.5rem; 
            background: none; 
            border: none;
            color: var(--text-gray);
            cursor: pointer;
            transition: var(--transition-fast);
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }
        .modal-close:hover {
            color: var(--primary);
            background: rgba(0,0,0,0.05);
        }
        
        /* Form Elements */
        .form-group {
            margin-bottom: 20px;
        }
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text-dark);
        }
        .form-input, .form-textarea, .form-select { 
            width: 100%; 
            padding: 14px; 
            margin-bottom: 15px; 
            border: 1px solid #ddd; 
            border-radius: var(--radius); 
            font-size: 1rem;
            transition: var(--transition-fast); 
            font-family: 'Montserrat', sans-serif;
            background: white;
        }
        .form-input:focus, .form-textarea:focus, .form-select:focus { 
            border-color: var(--primary); 
            outline: none; 
            box-shadow: 0 0 0 3px rgba(15, 61, 46, 0.1);
        }
        .form-textarea {
            min-height: 100px;
            resize: vertical;
        }
        .form-row {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }
        .form-row .form-group {
            flex: 1;
            margin-bottom: 0;
        }

        /* Toast Notification */
        .toast {
            position: fixed; 
            bottom: 30px; 
            left: 50%; 
            transform: translateX(-50%) translateY(50px);
            background: rgba(15, 61, 46, 0.95); 
            color: white; 
            padding: 16px 30px; 
            border-radius: 50px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2); 
            opacity: 0; 
            transition: 0.4s; 
            z-index: 3000;
            display: flex; 
            align-items: center; 
            gap: 12px; 
            font-weight: 500;
            max-width: 90%;
            text-align: center;
            backdrop-filter: blur(10px);
        }
        .toast.success { background: rgba(39, 174, 96, 0.95); }
        .toast.error { background: rgba(235, 87, 87, 0.95); }
        .toast.warning { background: rgba(242, 201, 76, 0.95); }
        .toast.show { 
            opacity: 1; 
            transform: translateX(-50%) translateY(0); 
        }
        .toast-icon {
            font-size: 1.2rem;
        }

        /* ===== ADMIN PANEL ===== */
        .admin-panel {
            padding: 20px;
            background: #f8f9fa;
            border-radius: var(--radius);
            margin-top: 20px;
        }
        .admin-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .stat-card {
            background: white;
            padding: 25px;
            border-radius: var(--radius);
            box-shadow: var(--shadow-soft);
            text-align: center;
        }
        .stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 10px;
        }
        .stat-label {
            color: var(--text-gray);
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .table-wrap { 
            overflow-x: auto; 
            margin-top: 20px;
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow-soft);
        }
        table { 
            width: 100%; 
            border-collapse: collapse; 
            font-size: 0.9rem; 
            min-width: 600px;
        }
        th { 
            text-align: left; 
            padding: 18px 15px; 
            background: #f8f8f8; 
            color: var(--primary); 
            font-family: 'Cormorant Garamond', serif; 
            font-size: 1.1rem; 
            font-weight: 600;
            border-bottom: 2px solid var(--border);
        }
        td { 
            padding: 15px; 
            border-bottom: 1px solid #eee; 
            vertical-align: top;
        }
        tr:hover {
            background: #f9f9f9;
        }
        .status-badge { 
            padding: 6px 12px; 
            border-radius: 20px; 
            font-size: 0.75rem; 
            font-weight: 600;
            display: inline-block;
        }
        .status-placed { background: #e3f2fd; color: #1976d2; }
        .status-confirmed { background: #e8f5e9; color: #388e3c; }
        .status-shipped { background: #fff3e0; color: #f57c00; }
        .status-delivered { background: #f3e5f5; color: #7b1fa2; }
        .status-cancelled { background: #ffebee; color: #d32f2f; }
        
        .action-buttons {
            display: flex;
            gap: 8px;
        }
        .action-btn {
            padding: 6px 12px;
            border-radius: var(--radius);
            border: none;
            font-size: 0.8rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition-fast);
        }
        .btn-edit { background: #e3f2fd; color: #1976d2; }
        .btn-delete { background: #ffebee; color: #d32f2f; }
        .btn-view { background: #e8f5e9; color: #388e3c; }

        /* ===== FOOTER ===== */
        footer { 
            background: var(--primary); 
            color: white; 
            padding: 80px 20px 40px; 
            margin-top: 100px; 
            text-align: center; 
        }
        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 40px;
            text-align: left;
            margin-bottom: 40px;
        }
        .footer-logo { 
            height: 70px; 
            margin-bottom: 20px; 
            border-radius: 5px; 
            display: inline-block; 
        }
        .footer-section h3 {
            color: var(--gold);
            margin-bottom: 20px;
            font-size: 1.3rem;
        }
        .footer-section ul {
            list-style: none;
        }
        .footer-section ul li {
            margin-bottom: 10px;
        }
        .footer-section ul li a {
            color: rgba(255,255,255,0.8);
            transition: var(--transition-fast);
        }
        .footer-section ul li a:hover {
            color: var(--gold);
            padding-left: 5px;
        }
        .footer-links { 
            display: flex; 
            justify-content: center; 
            gap: 30px; 
            margin: 40px 0; 
            font-size: 1.5rem; 
        }
        .footer-links a { 
            color: var(--gold); 
            transition: 0.3s; 
            width: 50px;
            height: 50px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            background: rgba(255,255,255,0.05);
        }
        .footer-links a:hover { 
            color: white; 
            background: var(--gold);
            transform: translateY(-5px);
        }
        .copyright {
            border-top: 1px solid rgba(255,255,255,0.1);
            padding-top: 30px;
            color: rgba(255,255,255,0.6);
            font-size: 0.9rem;
        }

        /* ===== RESPONSIVE DESIGN ===== */
        @media (max-width: 1200px) {
            .grid { gap: 25px; }
            .hero h1 { font-size: 3.5rem; }
        }
        
        @media (max-width: 992px) {
            .section { padding: 60px 20px; }
            .section-header h2 { font-size: 2.5rem; }
            .grid { grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); }
            .card-img-wrap { height: 320px; }
            .size-chart-container { grid-template-columns: 1fr; }
        }
        
        @media (max-width: 768px) {
            html { font-size: 15px; }
            .hero { height: 70vh; min-height: 500px; }
            .hero h1 { font-size: 2.8rem; }
            .grid { grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 20px; }
            .card-img-wrap { height: 280px; }
            .card-body { padding: 20px; }
            .section-header { margin-bottom: 40px; }
            .section-header h2 { font-size: 2.2rem; }
            .modal { padding: 30px 25px; }
            .footer-content { grid-template-columns: 1fr; text-align: center; }
            .products-header { flex-direction: column; align-items: stretch; }
            .filter-controls { justify-content: center; }
            .nav-icons { gap: 10px; }
            .icon-btn { width: 40px; height: 40px; }
            .ar-controls { grid-template-columns: 1fr; }
        }
        
        @media (max-width: 576px) {
            .grid { grid-template-columns: repeat(2, 1fr); }
            .card-img-wrap { height: 220px; }
            .hero h1 { font-size: 2.3rem; }
            .hero-subtitle { font-size: 0.8rem; letter-spacing: 2px; }
            .btn { padding: 14px 30px; }
            .drawer { max-width: 100%; }
            .form-row { flex-direction: column; gap: 0; }
            .size-opt { width: 32px; height: 32px; font-size: 0.75rem; }
            .wishlist-btn { width: 36px; height: 36px; }
            .size-chart-table th, .size-chart-table td { padding: 12px 8px; font-size: 0.9rem; }
        }
        
        @media (max-width: 400px) {
            .grid { grid-template-columns: 1fr; }
            .card-img-wrap { height: 300px; }
            .logo-text { font-size: 1.5rem; }
            .icon-btn { width: 36px; height: 36px; font-size: 1.1rem; }
        }
    </style>
</head>
<body>

<header id="mainHeader">
    <div class="nav-container">
        <a href="#" class="logo">
            <img src="aose ad.jpg" alt="AOSE Clothing Logo" class="logo-img">
            <span class="logo-text">AOSE</span>
        </a>
        <div class="nav-icons">
            <button class="icon-btn" onclick="openAdmin()" title="Admin Panel" aria-label="Admin Panel">
                <i class="fa-solid fa-shield-halved"></i>
            </button>
            <button class="icon-btn" onclick="openTrack()" title="Track Order" aria-label="Track Order">
                <i class="fa-solid fa-box-open"></i>
            </button>
            <button class="icon-btn" onclick="toggleAuth()" title="Profile" aria-label="Profile">
                <i class="fa-regular fa-user"></i>
                <span id="userLabel" class="user-label"></span>
            </button>
            <button class="icon-btn" onclick="openWishlist()" title="Wishlist" aria-label="Wishlist">
                <i class="fa-regular fa-heart"></i>
                <span class="badge" id="wishlistCount">0</span>
            </button>
            <button class="icon-btn" onclick="toggleCart()" title="Cart" aria-label="Cart">
                <i class="fa-solid fa-bag-shopping"></i>
                <span class="badge" id="cartCount">0</span>
            </button>
        </div>
    </div>
</header>

<section class="hero">
    <div class="hero-content">
        <span class="hero-subtitle">Premium Stitch & Wear</span>
        <h1>Elegance is an Attitude</h1>
        <p>Discover our curated collection of premium clothing, crafted for those who appreciate timeless style and exceptional quality.</p>
        <button class="btn btn-gold" onclick="document.getElementById('shop').scrollIntoView({behavior: 'smooth'})">
            Explore Collection
        </button>
    </div>
</section>

<section class="section" id="shop">
    <div class="container">
        <div class="section-header fade-up">
            <h2>Curated Selection</h2>
            <p>Handcrafted for the modern visionary.</p>
        </div>
        
        <div class="products-header">
            <div class="filter-controls">
                <select class="filter-select" id="sortSelect" onchange="sortProducts()">
                    <option value="default">Sort by</option>
                    <option value="price_asc">Price: Low to High</option>
                    <option value="price_desc">Price: High to Low</option>
                    <option value="name_asc">Name: A-Z</option>
                    <option value="name_desc">Name: Z-A</option>
                </select>
                <select class="filter-select" id="filterSelect" onchange="filterProducts()">
                    <option value="all">All Products</option>
                    <option value="new">New Arrivals</option>
                    <option value="best">Best Sellers</option>
                </select>
            </div>
            <div class="product-count">
                <span id="productCount">17</span> Products
            </div>
        </div>
        
        <div class="grid" id="productGrid">
            <!-- Products will be rendered here -->
        </div>
        
        <div class="text-center mt-4" id="loadingIndicator" style="display: none;">
            <div class="spinner"></div>
            <p>Loading more products...</p>
        </div>
    </div>
</section>

<!-- New Size Chart Section -->
<section class="section size-chart-section" id="sizeChart">
    <div class="container">
        <div class="section-header fade-up">
            <h2>Perfect Fit Guide</h2>
            <p>Premium measurements in inches for perfect tailoring</p>
        </div>
        
        <div class="size-chart-container fade-up">
            <div class="size-chart-info">
                <h3>Find Your Perfect Size</h3>
                <p>Our shirts are meticulously crafted to ensure the perfect fit. Use this chart to find your ideal size based on our premium measurements. Each size is designed with precision tailoring for maximum comfort and style.</p>
                
                <div class="size-tips">
                    <h4>Size Selection Tips</h4>
                    <ul>
                        <li>For a regular fit, choose your usual size</li>
                        <li>For a slim fit, consider going one size down</li>
                        <li>Check your chest measurement for the most accurate fit</li>
                        <li>If between sizes, we recommend sizing up</li>
                    </ul>
                </div>
            </div>
            
            <div class="size-chart-graphic">
                <div class="chart-table-container">
                    <table class="size-chart-table">
                        <thead>
                            <tr>
                                <th>SIZE</th>
                                <th>HEIGHT</th>
                                <th>SHOULDER</th>
                                <th>SLEEVE</th>
                                <th>CHEST</th>
                                <th>FRONT</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>S</strong></td>
                                <td class="measurement-highlight">26.5"</td>
                                <td>16"</td>
                                <td>22"</td>
                                <td>3.6"</td>
                                <td>10"</td>
                            </tr>
                            <tr>
                                <td><strong>M</strong></td>
                                <td class="measurement-highlight">26"</td>
                                <td>16.5"</td>
                                <td>22.5"</td>
                                <td>3.8"</td>
                                <td>10.5"</td>
                            </tr>
                            <tr>
                                <td><strong>L</strong></td>
                                <td class="measurement-highlight">29"</td>
                                <td>17"</td>
                                <td>23.5"</td>
                                <td>40"</td>
                                <td>11.5"</td>
                            </tr>
                            <tr>
                                <td><strong>XL</strong></td>
                                <td class="measurement-highlight">29.5"</td>
                                <td>18"</td>
                                <td>24"</td>
                                <td>42"</td>
                                <td>12"</td>
                            </tr>
                            <tr>
                                <td><strong>XXL</strong></td>
                                <td class="measurement-highlight">28.5"</td>
                                <td>19"</td>
                                <td>24.5"</td>
                                <td>44"</td>
                                <td>13"</td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <div class="size-illustration">
                        <div class="shirt-diagram" id="shirtDiagram">
                            <!-- Shirt diagram with measurement lines will be drawn by JS -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="text-center mt-4">
            <p class="text-gray">Stitch and Wear Collection - Shirt Size Chart</p>
            <button class="btn btn-outline" onclick="openARTryOn()">
                <i class="fa-solid fa-camera"></i> Try It On Virtually
            </button>
        </div>
    </div>
</section>

<!-- New AR Try-On Section -->
<section class="section ar-tryon-section" id="arTryOn">
    <div class="ar-container">
        <div class="ar-header fade-up">
            <h2>Virtual Try-On Experience</h2>
            <p>See how our premium shirts look on you in real-time using your camera</p>
        </div>
        
        <div class="ar-features fade-up">
            <div class="ar-feature">
                <i class="fa-solid fa-camera"></i>
                <h3>Real-Time Preview</h3>
                <p>See the shirt on your body instantly using your device's camera</p>
            </div>
            <div class="ar-feature">
                <i class="fa-solid fa-shirt"></i>
                <h3>Multiple Products</h3>
                <p>Try different styles and colors from our collection</p>
            </div>
            <div class="ar-feature">
                <i class="fa-solid fa-ruler-combined"></i>
                <h3>Perfect Fit Guide</h3>
                <p>Get personalized size recommendations</p>
            </div>
            <div class="ar-feature">
                <i class="fa-solid fa-mobile-screen"></i>
                <h3>Mobile Optimized</h3>
                <p>Works seamlessly on all devices with camera access</p>
            </div>
        </div>
        
        <div class="ar-main fade-up">
            <div class="ar-controls">
                <div class="ar-product-selector">
                    <h3>Select Product to Try</h3>
                    <div class="ar-products-grid" id="arProductsGrid">
                        <!-- AR products will be loaded here -->
                    </div>
                </div>
                
                <div class="ar-camera-container">
                    <h3>Camera Preview</h3>
                    <div class="ar-preview" id="arPreview">
                        <video id="arVideo" autoplay muted playsinline></video>
                        <canvas id="arCanvas"></canvas>
                        <div class="ar-overlay-controls">
                            <button onclick="toggleCamera()" id="cameraToggleBtn">
                                <i class="fa-solid fa-camera"></i> Start Camera
                            </button>
                            <button onclick="captureFit()" id="captureBtn" style="display: none;">
                                <i class="fa-solid fa-camera-retro"></i> Check Fit
                            </button>
                        </div>
                    </div>
                    
                    <div class="ar-control-buttons">
                        <button class="btn btn-gold" onclick="startARTryOn()">
                            <i class="fa-solid fa-play"></i> Start AR Try-On
                        </button>
                        <button class="btn btn-outline" onclick="resetAR()">
                            <i class="fa-solid fa-rotate-left"></i> Reset
                        </button>
                        <button class="btn btn-outline" onclick="adjustShirtSize('increase')">
                            <i class="fa-solid fa-plus"></i> Larger
                        </button>
                        <button class="btn btn-outline" onclick="adjustShirtSize('decrease')">
                            <i class="fa-solid fa-minus"></i> Smaller
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="ar-instructions">
                <h3>How to Use AR Try-On</h3>
                <div class="ar-steps">
                    <div class="ar-step">
                        <h4>Allow Camera Access</h4>
                        <p>Click "Start Camera" and allow access to your device's camera</p>
                    </div>
                    <div class="ar-step">
                        <h4>Select Product</h4>
                        <p>Choose any shirt from our collection to try on virtually</p>
                    </div>
                    <div class="ar-step">
                        <h4>Position Yourself</h4>
                        <p>Stand 3-5 feet from camera for best results</p>
                    </div>
                    <div class="ar-step">
                        <h4>Check Fit</h4>
                        <p>Use "Check Fit" to get size recommendations</p>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="ar-fit-guide" id="fitGuide" style="display: none;">
            <h3>Fit Analysis Result</h3>
            <div class="fit-indicators" id="fitIndicators">
                <!-- Fit indicators will be shown here -->
            </div>
        </div>
    </div>
</section>

<footer>
    <div class="container">
        <div class="footer-content">
            <div class="footer-section">
                <img src="aose ad.jpg" class="footer-logo" alt="AOSE">
                <h3>AOSE CLOTHING</h3>
                <p>Premium clothing for the discerning individual. Timeless elegance in every stitch.</p>
            </div>
            
            <div class="footer-section">
                <h3>Quick Links</h3>
                <ul>
                    <li><a href="#shop">Shop</a></li>
                    <li><a href="#sizeChart">Size Chart</a></li>
                    <li><a href="#arTryOn">Virtual Try-On</a></li>
                    <li><a href="#" onclick="openTrack(); return false;">Track Order</a></li>
                    <li><a href="#" onclick="openWishlist(); return false;">Wishlist</a></li>
                    <li><a href="#" onclick="toggleAuth(); return false;">My Account</a></li>
                </ul>
            </div>
            
            <div class="footer-section">
                <h3>Contact Us</h3>
                <ul>
                    <li><i class="fa-solid fa-phone"></i> +91 78877 31818</li>
                    <li><i class="fa-solid fa-envelope"></i> info@aoseclothing.com</li>
                    <li><i class="fa-solid fa-location-dot"></i> Premium Fashion District</li>
                </ul>
            </div>
        </div>
        
        <div class="footer-links">
            <a href="https://wa.me/917887731818" target="_blank" title="WhatsApp"><i class="fa-brands fa-whatsapp"></i></a>
            <a href="https://instagram.com" target="_blank" title="Instagram"><i class="fa-brands fa-instagram"></i></a>
            <a href="mailto:info@aoseclothing.com" title="Email"><i class="fa-regular fa-envelope"></i></a>
            <a href="https://facebook.com" target="_blank" title="Facebook"><i class="fa-brands fa-facebook-f"></i></a>
        </div>
        
        <div class="copyright">
            <p>&copy; 2026 AOSE Clothing. All rights reserved. | Premium Stitch & Wear</p>
        </div>
    </div>
</footer>

<!-- Overlay -->
<div class="overlay" id="overlay" onclick="closeAll()"></div>

<!-- Cart Drawer -->
<div class="drawer" id="cartDrawer">
    <div class="drawer-header">
        <h3>Shopping Bag</h3>
        <button class="modal-close" onclick="toggleCart()" aria-label="Close cart">
            <i class="fa-solid fa-xmark"></i>
        </button>
    </div>
    <div class="drawer-body" id="cartItems">
        <!-- Cart items will be rendered here -->
    </div>
    <div class="drawer-footer">
        <div class="cart-summary">
            <div class="summary-row">
                <span>Subtotal</span>
                <span id="cartSubtotal">â‚¹0</span>
            </div>
            <div class="summary-row">
                <span>Shipping</span>
                <span id="cartShipping">Free</span>
            </div>
            <div class="summary-row total">
                <span>Total</span>
                <span id="cartTotal">â‚¹0</span>
            </div>
        </div>
        <button class="btn-full" onclick="openCheckout()">PROCEED TO CHECKOUT</button>
        <button class="btn btn-outline btn-small" onclick="clearCart()" style="width:100%; margin-top:15px;">
            Clear Cart
        </button>
    </div>
</div>

<!-- Wishlist Modal -->
<div class="modal" id="wishlistModal">
    <button class="modal-close" onclick="closeAll()" aria-label="Close">
        <i class="fa-solid fa-times"></i>
    </button>
    <h2 class="text-center mb-3">My Wishlist</h2>
    <div id="wishlistContent">
        <!-- Wishlist items will be rendered here -->
    </div>
</div>

<!-- Auth Modal -->
<div class="modal" id="authModal">
    <button class="modal-close" onclick="closeAll()" aria-label="Close">
        <i class="fa-solid fa-times"></i>
    </button>
    <h2 class="text-center mb-3" id="authTitle">Sign In</h2>
    
    <div id="loginForm">
        <div class="form-group">
            <input type="text" id="uName" class="form-input" placeholder="Full Name" required>
        </div>
        <div class="form-group">
            <input type="email" id="uEmail" class="form-input" placeholder="Email Address" required>
        </div>
        <div class="form-group">
            <input type="tel" id="uPhone" class="form-input" placeholder="Phone Number" required>
        </div>
        <button class="btn-full" onclick="login()">Access Account</button>
    </div>

    <div id="profileView" style="display:none;">
        <p class="text-center mb-3">Logged in as <strong id="profileName" class="text-primary"></strong></p>
        
        <h4 class="mb-2">Order History</h4>
        <div class="order-history" id="orderHistory">
            <!-- Order history will be rendered here -->
        </div>
        
        <button class="btn-full" style="background:#333; margin-top:20px;" onclick="logout()">Sign Out</button>
    </div>
</div>

<!-- Checkout Modal -->
<div class="modal" id="checkoutModal">
    <button class="modal-close" onclick="closeAll()" aria-label="Close">
        <i class="fa-solid fa-times"></i>
    </button>
    
    <div id="step1">
        <h2 class="text-center mb-3">Shipping Details</h2>
        <div class="form-group">
            <input type="text" id="cName" class="form-input" placeholder="Full Name" required>
        </div>
        <div class="form-row">
            <div class="form-group">
                <input type="tel" id="cPhone" class="form-input" placeholder="WhatsApp Number" required>
            </div>
            <div class="form-group">
                <input type="email" id="cEmail" class="form-input" placeholder="Email" required>
            </div>
        </div>
        <div class="form-group">
            <textarea id="cAddr" class="form-input" rows="3" placeholder="Shipping Address" required></textarea>
        </div>
        <div class="form-group">
            <input type="text" id="cCity" class="form-input" placeholder="City" required>
        </div>
        <div class="form-row">
            <div class="form-group">
                <input type="text" id="cState" class="form-input" placeholder="State" required>
            </div>
            <div class="form-group">
                <input type="text" id="cPincode" class="form-input" placeholder="Pincode" required>
            </div>
        </div>
        <button class="btn-full" onclick="validateShipping()">Continue to Payment</button>
    </div>

    <div id="step2" style="display:none;">
        <h2 class="text-center mb-2">Complete Payment</h2>
        <p class="text-center text-gray mb-3">Total Amount: â‚¹<span id="payAmount"></span></p>
        
        <div class="payment-options">
            <h4 class="mb-2">Choose Payment Method</h4>
            <div class="payment-methods">
                <button class="payment-option active" onclick="selectPayment('upi')">
                    <i class="fa-solid fa-qrcode"></i>
                    <span>UPI / QR Code</span>
                </button>
                <button class="payment-option" onclick="selectPayment('phonepe')">
                    <i class="fa-solid fa-mobile-screen"></i>
                    <span>PhonePe</span>
                </button>
                <button class="payment-option" onclick="selectPayment('gpay')">
                    <i class="fa-brands fa-google-pay"></i>
                    <span>Google Pay</span>
                </button>
                <button class="payment-option" onclick="selectPayment('paytm')">
                    <i class="fa-solid fa-wallet"></i>
                    <span>Paytm</span>
                </button>
            </div>
        </div>
        
        <div id="upiSection" class="payment-details">
            <div class="text-center mb-3">
                <p>Scan QR Code or Use UPI ID</p>
                <div id="qrcode" class="qrcode-container"></div>
                <p class="upi-id">UPI ID: <strong id="upiIdDisplay">7887731818@ybl</strong></p>
            </div>
        </div>
        
        <button class="btn-full" onclick="confirmOrder()">Confirm Payment & Place Order</button>
        <button class="btn btn-outline btn-small" onclick="backToShipping()" style="width:100%; margin-top:15px;">
            Back to Shipping
        </button>
    </div>

    <div id="step3" style="display:none; text-align:center;">
        <i class="fa-solid fa-circle-check" style="font-size:4rem; color:var(--gold); margin-bottom:20px;"></i>
        <h2 class="mb-2">Order Confirmed!</h2>
        <p class="mb-2">Thank you for your purchase.</p>
        <p>Order ID: <strong id="finalId" class="text-primary"></strong></p>
        <div class="order-details mt-3">
            <p>We've sent the order details to your email and WhatsApp.</p>
        </div>
        <button class="btn-full" onclick="downloadInvoice()" style="margin-top:20px; background:#333;">
            <i class="fa-solid fa-download"></i> Download Invoice
        </button>
        <button class="btn btn-outline btn-small" onclick="closeAll(); window.location.href='#shop';" style="width:100%; margin-top:15px;">
            Continue Shopping
        </button>
    </div>
</div>

<!-- Admin Modal -->
<div class="modal" id="adminModal" style="max-width:900px;">
    <button class="modal-close" onclick="closeAll()" aria-label="Close">
        <i class="fa-solid fa-times"></i>
    </button>
    <h2 class="text-center mb-3">Admin Portal</h2>
    
    <div id="adminLogin">
        <div class="form-group">
            <input type="password" id="admPass" class="form-input" placeholder="Admin Password" required>
        </div>
        <button class="btn-full" onclick="checkAdmin()">Login</button>
    </div>

    <div id="adminDash" style="display:none;">
        <div class="admin-stats">
            <div class="stat-card">
                <div class="stat-value" id="totalOrders">0</div>
                <div class="stat-label">Total Orders</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="totalRevenue">â‚¹0</div>
                <div class="stat-label">Total Revenue</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="pendingOrders">0</div>
                <div class="stat-label">Pending Orders</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="totalUsers">0</div>
                <div class="stat-label">Total Users</div>
            </div>
        </div>
        
        <div class="admin-actions">
            <div style="display:flex; gap:10px; margin-bottom:20px; flex-wrap:wrap;">
                <button class="btn-full" style="background:#217346; width:auto; flex:1;" onclick="exportExcel()">
                    <i class="fa-solid fa-file-excel"></i> Export Excel
                </button>
                <button class="btn-full" style="background:#dc3545; width:auto; flex:1;" onclick="resetDB()">
                    <i class="fa-solid fa-trash"></i> Reset Data
                </button>
                <button class="btn-full" style="background:#6c757d; width:auto; flex:1;" onclick="refreshOrders()">
                    <i class="fa-solid fa-sync"></i> Refresh
                </button>
            </div>
        </div>
        
        <div class="table-wrap">
            <table id="adminTable">
                <thead>
                    <tr>
                        <th>Order ID</th>
                        <th>Customer</th>
                        <th>Items</th>
                        <th>Amount</th>
                        <th>Status</th>
                        <th>Date</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="adminTableBody">
                    <!-- Orders will be rendered here -->
                </tbody>
            </table>
        </div>
    </div>
</div>

<!-- Track Order Modal -->
<div class="modal" id="trackModal">
    <button class="modal-close" onclick="closeAll()" aria-label="Close">
        <i class="fa-solid fa-times"></i>
    </button>
    <h2 class="text-center mb-3">Track Order</h2>
    <div class="form-group">
        <input type="text" id="trackInput" class="form-input" placeholder="Order ID (e.g., AOSE-1234)" required>
    </div>
    <button class="btn-full" onclick="doTrack()">Check Status</button>
    <div id="trackRes" class="track-result">
        <!-- Tracking results will be displayed here -->
    </div>
</div>

<!-- Hidden Invoice Template -->
<div id="invoice" style="display:none; padding:40px; font-family:'Montserrat', sans-serif; background:white; max-width:800px; margin:0 auto;">
    <div style="border-bottom:2px solid var(--primary); padding-bottom:20px; margin-bottom:30px;">
        <table style="width:100%;">
            <tr>
                <td>
                    <h1 style="color:var(--primary); margin:0;">AOSE CLOTHING</h1>
                    <p style="color:var(--text-gray); margin:5px 0 0 0;">Premium Stitch & Wear</p>
                </td>
                <td style="text-align:right;">
                    <h3 style="margin:0; color:var(--primary);">INVOICE</h3>
                    <p style="margin:5px 0 0 0; color:var(--text-gray);" id="invDate"></p>
                </td>
            </tr>
        </table>
    </div>
    
    <table style="width:100%; margin-bottom:30px;">
        <tr>
            <td style="width:50%; vertical-align:top;">
                <h4 style="color:var(--primary); margin-bottom:10px;">Bill To:</h4>
                <p style="margin:5px 0;"><strong id="invName"></strong></p>
                <p style="margin:5px 0;" id="invAddress"></p>
                <p style="margin:5px 0;">Phone: <span id="invPhone"></span></p>
                <p style="margin:5px 0;">Email: <span id="invEmail"></span></p>
            </td>
            <td style="width:50%; vertical-align:top; text-align:right;">
                <h4 style="color:var(--primary); margin-bottom:10px;">Order Details:</h4>
                <p style="margin:5px 0;">Order ID: <strong id="invId"></strong></p>
                <p style="margin:5px 0;">Date: <span id="invOrderDate"></span></p>
                <p style="margin:5px 0;">Status: <span id="invStatus" style="color:var(--gold); font-weight:600;"></span></p>
            </td>
        </tr>
    </table>
    
    <table style="width:100%; border-collapse:collapse; margin-top:20px; margin-bottom:30px;">
        <thead>
            <tr style="border-bottom:2px solid var(--primary);">
                <th style="padding:12px; text-align:left; color:var(--primary);">Item</th>
                <th style="padding:12px; text-align:center; color:var(--primary);">Size</th>
                <th style="padding:12px; text-align:center; color:var(--primary);">Qty</th>
                <th style="padding:12px; text-align:right; color:var(--primary);">Price</th>
                <th style="padding:12px; text-align:right; color:var(--primary);">Total</th>
            </tr>
        </thead>
        <tbody id="invItems">
            <!-- Invoice items will be rendered here -->
        </tbody>
        <tfoot>
            <tr>
                <td colspan="4" style="text-align:right; padding:12px; font-weight:600;">Subtotal</td>
                <td style="text-align:right; padding:12px;">â‚¹<span id="invSubtotal"></span></td>
            </tr>
            <tr>
                <td colspan="4" style="text-align:right; padding:12px; font-weight:600;">Shipping</td>
                <td style="text-align:right; padding:12px;">Free</td>
            </tr>
            <tr style="border-top:2px solid var(--primary);">
                <td colspan="4" style="text-align:right; padding:12px; font-weight:700; color:var(--primary);">Total</td>
                <td style="text-align:right; padding:12px; font-weight:700; color:var(--primary);">â‚¹<span id="invTotal"></span></td>
            </tr>
        </tfoot>
    </table>
    
    <div style="border-top:1px solid #eee; padding-top:20px; margin-top:30px; text-align:center; color:var(--text-gray); font-size:0.9rem;">
        <p>Thank you for your purchase!</p>
        <p>For any queries, contact us at info@aoseclothing.com or +91 78877 31818</p>
        <p style="margin-top:20px;">This is a computer-generated invoice and does not require a signature.</p>
    </div>
</div>

<!-- Toast Notification -->
<div class="toast" id="toast">
    <i class="toast-icon fa-solid fa-check"></i>
    <span class="toast-message">Message</span>
</div>

<script>
// ===== CONFIGURATION =====
const CONFIG = {
    upiId: "7887731818@ybl",
    adminPass: "admin123",
    storeName: "AOSE Clothing",
    storeEmail: "info@aoseclothing.com",
    storePhone: "+91 78877 31818",
    shippingFee: 0,
    currency: "â‚¹"
};

// ===== SIZE CHART DATA =====
const sizeChartData = {
    "S": { height: "26.5", shoulder: "16", sleeve: "22", chest: "3.6", front: "10" },
    "M": { height: "26", shoulder: "16.5", sleeve: "22.5", chest: "3.8", front: "10.5" },
    "L": { height: "29", shoulder: "17", sleeve: "23.5", chest: "40", front: "11.5" },
    "XL": { height: "29.5", shoulder: "18", sleeve: "24", chest: "42", front: "12" },
    "XXL": { height: "28.5", shoulder: "19", sleeve: "24.5", chest: "44", front: "13" }
};

// ===== PRODUCT DATABASE =====
const products = [
    { id: 1, name: "Midnight Navy", price: 1499, img: "pro17.jpg", category: "premium", label: "new", stock: 10, arImage: "pro17.jpg" },
    { id: 2, name: "Azure Executive", price: 1299, img: "propro2.jpg", category: "formal", label: "best", stock: 15, arImage: "propro2.jpg" },
    { id: 3, name: "Skyline Stripe", price: 1199, img: "pro5.jpg", category: "casual", label: "", stock: 8, arImage: "pro5.jpg" },
    { id: 4, name: "Royal Grid Check", price: 1149, img: "pro2.jpg", category: "formal", label: "", stock: 12, arImage: "pro2.jpg" },
    { id: 5, name: "Botanic Azure", price: 1399, img: "propro.jpg", category: "premium", label: "new", stock: 5, arImage: "propro.jpg" },
    { id: 6, name: "Ocean Weave", price: 1099, img: "pro3.jpg", category: "casual", label: "", stock: 20, arImage: "pro3.jpg" },
    { id: 7, name: "Ivory Motif", price: 999, img: "pro.jpg", category: "casual", label: "sale", salePrice: 799, stock: 18, arImage: "pro.jpg" },
    { id: 8, name: "Rose Linear", price: 1199, img: "pro4.jpg", category: "formal", label: "", stock: 10, arImage: "pro4.jpg" },
    { id: 9, name: "Pristine White", price: 1599, img: "proo16.jpg", category: "premium", label: "new", stock: 7, arImage: "proo16.jpg" },
    { id: 10, name: "Sage Serenity", price: 1249, img: "proo2.jpg", category: "formal", label: "", stock: 14, arImage: "proo2.jpg" },
    { id: 11, name: "Blush Formal", price: 1149, img: "proo12.jpg", category: "formal", label: "", stock: 11, arImage: "proo12.jpg" },
    { id: 12, name: "Cobalt Check", price: 1099, img: "proo11.jpg", category: "casual", label: "sale", salePrice: 899, stock: 9, arImage: "proo11.jpg" },
    { id: 13, name: "Slate Microdot", price: 1299, img: "pro13.jpg", category: "premium", label: "", stock: 6, arImage: "pro13.jpg" },
    { id: 14, name: "Granite Texture", price: 1349, img: "proo10.jpg", category: "formal", label: "", stock: 13, arImage: "proo10.jpg" },
    { id: 15, name: "Crimson Depth", price: 1449, img: "proo15.jpg", category: "premium", label: "best", stock: 4, arImage: "proo15.jpg" },
    { id: 16, name: "Crimson Stripe", price: 1199, img: "proo9.jpg", category: "casual", label: "", stock: 16, arImage: "proo9.jpg" },
    { id: 17, name: "Nautical Stripe", price: 1299, img: "proo14.jpg", category: "casual", label: "best", stock: 12, arImage: "proo14.jpg" }
];

// ===== STATE MANAGEMENT =====
let cart = JSON.parse(localStorage.getItem('aose_cart')) || [];
let wishlist = JSON.parse(localStorage.getItem('aose_wishlist')) || [];
let orders = JSON.parse(localStorage.getItem('aose_orders')) || [];
let users = JSON.parse(localStorage.getItem('aose_users')) || [];
let user = JSON.parse(localStorage.getItem('aose_user')) || null;
let currentOrder = null;
let selections = {};
let currentFilter = 'all';
let currentSort = 'default';

// ===== AR TRY-ON STATE =====
let arActive = false;
let cameraStream = null;
let currentArProduct = null;
let shirtScale = 1.0;
let shirtX = 0;
let shirtY = 0;
let animationId = null;
let fitCheckResult = null;

// ===== INITIALIZATION =====
window.onload = function() {
    initApp();
};

function initApp() {
    renderShop();
    updateCartUI();
    updateUserUI();
    setupEventListeners();
    setupScrollAnimation();
    createShirtDiagram();
    loadARProducts();
    
    // Check for saved users and populate if empty
    if (users.length === 0) {
        users = [
            { name: "Admin User", email: "admin@aose.com", phone: "7887731818", orders: [] }
        ];
        localStorage.setItem('aose_users', JSON.stringify(users));
    }
}

function setupEventListeners() {
    // Header scroll effect
    window.addEventListener('scroll', function() {
        const header = document.getElementById('mainHeader');
        if (window.scrollY > 50) {
            header.classList.add('scrolled');
        } else {
            header.classList.remove('scrolled');
        }
    });
    
    // Close modals with Escape key
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') {
            closeAll();
        }
    });
    
    // Handle window resize for AR
    window.addEventListener('resize', function() {
        if (arActive) {
            updateCanvasSize();
        }
    });
}

function setupScrollAnimation() {
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.classList.add('visible');
            }
        });
    }, { threshold: 0.1 });
    
    document.querySelectorAll('.fade-up, .fade-in, .scale-up').forEach(el => observer.observe(el));
}

// ===== SIZE CHART FUNCTIONS =====
function createShirtDiagram() {
    const diagram = document.getElementById('shirtDiagram');
    if (!diagram) return;
    
    // Create SVG for shirt diagram
    const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
    svg.setAttribute("viewBox", "0 0 200 300");
    svg.setAttribute("width", "100%");
    svg.setAttribute("height", "100%");
    
    // Shirt outline
    const shirtPath = document.createElementNS("http://www.w3.org/2000/svg", "path");
    shirtPath.setAttribute("d", "M50,50 Q100,20 150,50 L180,150 Q200,200 150,250 L50,250 Q0,200 20,150 Z");
    shirtPath.setAttribute("fill", "var(--cream)");
    shirtPath.setAttribute("stroke", "var(--gold)");
    shirtPath.setAttribute("stroke-width", "2");
    svg.appendChild(shirtPath);
    
    // Measurement lines with labels
    const measurements = [
        { x1: 100, y1: 50, x2: 100, y2: 250, label: "HEIGHT", value: "29\"", x: 110, y: 150 },
        { x1: 50, y1: 100, x2: 150, y2: 100, label: "SHOULDER", value: "18\"", x: 100, y: 90 },
        { x1: 180, y1: 150, x2: 250, y2: 150, label: "SLEEVE", value: "24\"", x: 215, y: 140 },
        { x1: 60, y1: 150, x2: 140, y2: 150, label: "CHEST", value: "42\"", x: 100, y: 165 },
        { x1: 100, y1: 200, x2: 100, y2: 250, label: "FRONT", value: "12\"", x: 110, y: 225 }
    ];
    
    measurements.forEach(meas => {
        // Measurement line
        const line = document.createElementNS("http://www.w3.org/2000/svg", "line");
        line.setAttribute("x1", meas.x1);
        line.setAttribute("y1", meas.y1);
        line.setAttribute("x2", meas.x2);
        line.setAttribute("y2", meas.y2);
        line.setAttribute("stroke", "var(--primary)");
        line.setAttribute("stroke-width", "1.5");
        line.setAttribute("stroke-dasharray", "5,5");
        svg.appendChild(line);
        
        // Label background
        const labelBg = document.createElementNS("http://www.w3.org/2000/svg", "rect");
        labelBg.setAttribute("x", meas.x - 30);
        labelBg.setAttribute("y", meas.y - 15);
        labelBg.setAttribute("width", "60");
        labelBg.setAttribute("height", "30");
        labelBg.setAttribute("fill", "var(--primary)");
        labelBg.setAttribute("rx", "4");
        svg.appendChild(labelBg);
        
        // Label text
        const labelText = document.createElementNS("http://www.w3.org/2000/svg", "text");
        labelText.setAttribute("x", meas.x);
        labelText.setAttribute("y", meas.y);
        labelText.setAttribute("text-anchor", "middle");
        labelText.setAttribute("fill", "white");
        labelText.setAttribute("font-size", "10");
        labelText.setAttribute("font-weight", "bold");
        labelText.textContent = meas.label;
        svg.appendChild(labelText);
        
        // Value text
        const valueText = document.createElementNS("http://www.w3.org/2000/svg", "text");
        valueText.setAttribute("x", meas.x);
        valueText.setAttribute("y", meas.y + 20);
        valueText.setAttribute("text-anchor", "middle");
        valueText.setAttribute("fill", "var(--gold)");
        valueText.setAttribute("font-size", "12");
        valueText.setAttribute("font-weight", "bold");
        valueText.textContent = meas.value;
        svg.appendChild(valueText);
    });
    
    diagram.innerHTML = '';
    diagram.appendChild(svg);
}

// ===== AR TRY-ON FUNCTIONS =====
function loadARProducts() {
    const arGrid = document.getElementById('arProductsGrid');
    if (!arGrid) return;
    
    // Select 6 products for AR try-on
    const arProducts = products.slice(0, 6);
    
    arGrid.innerHTML = arProducts.map((product, index) => `
        <div class="ar-product-thumb ${index === 0 ? 'active' : ''}" 
             onclick="selectARProduct(${product.id})"
             data-product-id="${product.id}">
            <img src="${product.img}" alt="${product.name}">
        </div>
    `).join('');
    
    // Set first product as current
    if (arProducts.length > 0) {
        currentArProduct = arProducts[0];
    }
}

function selectARProduct(productId) {
    const product = products.find(p => p.id === productId);
    if (!product) return;
    
    currentArProduct = product;
    
    // Update active state
    document.querySelectorAll('.ar-product-thumb').forEach(thumb => {
        thumb.classList.remove('active');
    });
    document.querySelector(`.ar-product-thumb[data-product-id="${productId}"]`).classList.add('active');
    
    showToast(`Selected: ${product.name}`, "success");
}

function openARTryOn() {
    // Scroll to AR section
    document.getElementById('arTryOn').scrollIntoView({ behavior: 'smooth' });
}

function startARTryOn() {
    if (arActive) {
        showToast("AR Try-On is already active", "warning");
        return;
    }
    
    startCamera();
}

async function startCamera() {
    try {
        const constraints = {
            video: {
                facingMode: 'user',
                width: { ideal: 1280 },
                height: { ideal: 720 }
            }
        };
        
        cameraStream = await navigator.mediaDevices.getUserMedia(constraints);
        
        const video = document.getElementById('arVideo');
        video.srcObject = cameraStream;
        video.style.display = 'block';
        
        // Wait for video to load
        video.onloadedmetadata = () => {
            video.play();
            arActive = true;
            updateCanvasSize();
            drawShirtOnVideo();
            
            // Update UI
            document.getElementById('cameraToggleBtn').innerHTML = '<i class="fa-solid fa-camera-slash"></i> Stop Camera';
            document.getElementById('captureBtn').style.display = 'inline-flex';
            
            showToast("Camera started. Position yourself in frame.", "success");
        };
    } catch (error) {
        console.error("Error accessing camera:", error);
        showToast("Could not access camera. Please check permissions.", "error");
        
        // Fallback: Show static shirt image
        if (currentArProduct) {
            const canvas = document.getElementById('arCanvas');
            const ctx = canvas.getContext('2d');
            
            // Draw placeholder
            ctx.fillStyle = '#333';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = 'white';
            ctx.font = '20px Montserrat';
            ctx.textAlign = 'center';
            ctx.fillText('Camera access required for AR Try-On', canvas.width/2, canvas.height/2);
            
            showToast("Camera access is required for full AR experience", "warning");
        }
    }
}

function toggleCamera() {
    if (arActive) {
        stopCamera();
    } else {
        startCamera();
    }
}

function stopCamera() {
    if (cameraStream) {
        cameraStream.getTracks().forEach(track => track.stop());
        cameraStream = null;
    }
    
    if (animationId) {
        cancelAnimationFrame(animationId);
        animationId = null;
    }
    
    arActive = false;
    
    // Clear canvas
    const canvas = document.getElementById('arCanvas');
    const ctx = canvas.getContext('2d');
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    
    // Hide video
    const video = document.getElementById('arVideo');
    video.style.display = 'none';
    
    // Update UI
    document.getElementById('cameraToggleBtn').innerHTML = '<i class="fa-solid fa-camera"></i> Start Camera';
    document.getElementById('captureBtn').style.display = 'none';
    
    showToast("Camera stopped", "info");
}

function updateCanvasSize() {
    const video = document.getElementById('arVideo');
    const canvas = document.getElementById('arCanvas');
    
    if (video.videoWidth && video.videoHeight) {
        canvas.width = video.videoWidth;
        canvas.height = video.videoHeight;
    } else {
        // Fallback dimensions
        canvas.width = 640;
        canvas.height = 480;
    }
}

function drawShirtOnVideo() {
    if (!arActive || !currentArProduct) return;
    
    const video = document.getElementById('arVideo');
    const canvas = document.getElementById('arCanvas');
    const ctx = canvas.getContext('2d');
    
    // Clear canvas
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    
    // Draw video frame
    ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
    
    // Create a shirt image overlay
    const shirtImg = new Image();
    shirtImg.src = currentArProduct.img;
    shirtImg.onload = () => {
        // Calculate shirt position (centered on torso)
        const shirtWidth = canvas.width * 0.4 * shirtScale;
        const shirtHeight = shirtWidth * 1.5;
        
        shirtX = shirtX || (canvas.width - shirtWidth) / 2;
        shirtY = shirtY || canvas.height * 0.3;
        
        // Draw shirt with transparency
        ctx.save();
        ctx.globalAlpha = 0.7;
        
        // Create clipping path for shirt shape
        ctx.beginPath();
        ctx.moveTo(shirtX + shirtWidth * 0.2, shirtY);
        ctx.bezierCurveTo(
            shirtX + shirtWidth * 0.5, shirtY - shirtHeight * 0.1,
            shirtX + shirtWidth * 0.8, shirtY,
            shirtX + shirtWidth * 0.9, shirtY + shirtHeight * 0.1
        );
        ctx.lineTo(shirtX + shirtWidth, shirtY + shirtHeight * 0.6);
        ctx.bezierCurveTo(
            shirtX + shirtWidth * 0.9, shirtY + shirtHeight * 0.9,
            shirtX + shirtWidth * 0.1, shirtY + shirtHeight * 0.9,
            shirtX, shirtY + shirtHeight * 0.6
        );
        ctx.lineTo(shirtX + shirtWidth * 0.1, shirtY + shirtHeight * 0.1);
        ctx.bezierCurveTo(
            shirtX + shirtWidth * 0.2, shirtY,
            shirtX + shirtWidth * 0.3, shirtY - shirtHeight * 0.05,
            shirtX + shirtWidth * 0.2, shirtY
        );
        ctx.closePath();
        ctx.clip();
        
        // Draw shirt image
        ctx.drawImage(shirtImg, shirtX, shirtY, shirtWidth, shirtHeight);
        ctx.restore();
        
        // Draw outline
        ctx.strokeStyle = 'rgba(198, 166, 100, 0.8)';
        ctx.lineWidth = 3;
        ctx.stroke();
        
        // Draw product name
        ctx.fillStyle = 'rgba(15, 61, 46, 0.9)';
        ctx.font = 'bold 16px Montserrat';
        ctx.textAlign = 'center';
        ctx.fillText(currentArProduct.name, shirtX + shirtWidth/2, shirtY - 10);
        
        // Draw size indicator
        ctx.fillStyle = 'rgba(198, 166, 100, 0.9)';
        ctx.fillRect(shirtX + shirtWidth/2 - 30, shirtY + shirtHeight + 10, 60, 25);
        ctx.fillStyle = 'white';
        ctx.font = 'bold 14px Montserrat';
        ctx.fillText(`Scale: ${shirtScale.toFixed(1)}x`, shirtX + shirtWidth/2, shirtY + shirtHeight + 27);
    };
    
    // Continue animation
    animationId = requestAnimationFrame(drawShirtOnVideo);
}

function adjustShirtSize(action) {
    if (action === 'increase') {
        shirtScale = Math.min(shirtScale + 0.1, 1.5);
    } else if (action === 'decrease') {
        shirtScale = Math.max(shirtScale - 0.1, 0.5);
    }
    
    showToast(`Shirt scale: ${shirtScale.toFixed(1)}x`, "info");
}

function captureFit() {
    if (!arActive) {
        showToast("Please start the camera first", "warning");
        return;
    }
    
    // Simulate fit analysis
    analyzeFit();
}

function analyzeFit() {
    // Simulate fit analysis based on current scale
    const fitScore = Math.min(Math.max(Math.round((1.0 - Math.abs(1.0 - shirtScale)) * 100), 0), 100);
    
    // Determine fit level
    let fitLevel, fitColor, fitIcon;
    if (fitScore >= 80) {
        fitLevel = "Perfect Fit";
        fitColor = "good";
        fitIcon = "fa-check-circle";
    } else if (fitScore >= 60) {
        fitLevel = "Good Fit";
        fitColor = "warning";
        fitIcon = "fa-adjust";
    } else {
        fitLevel = "Needs Adjustment";
        fitColor = "bad";
        fitIcon = "fa-exclamation-triangle";
    }
    
    // Show fit guide
    const fitGuide = document.getElementById('fitGuide');
    const fitIndicators = document.getElementById('fitIndicators');
    
    fitIndicators.innerHTML = `
        <div class="fit-indicator ${fitColor}">
            <i class="fa-solid ${fitIcon}"></i>
            <h4>${fitLevel}</h4>
            <p>Fit Score: ${fitScore}%</p>
            <p>Scale: ${shirtScale.toFixed(1)}x</p>
        </div>
        <div class="fit-indicator">
            <i class="fa-solid fa-ruler-combined"></i>
            <h4>Recommended Size</h4>
            <p>${getRecommendedSize()}</p>
            <p>Based on your fit analysis</p>
        </div>
        <div class="fit-indicator">
            <i class="fa-solid fa-lightbulb"></i>
            <h4>Recommendation</h4>
            <p>${getFitRecommendation(fitScore)}</p>
            <p>For the best fit experience</p>
        </div>
    `;
    
    fitGuide.style.display = 'block';
    fitGuide.scrollIntoView({ behavior: 'smooth' });
    
    showToast("Fit analysis complete!", "success");
}

function getRecommendedSize() {
    // Simple size recommendation based on scale
    if (shirtScale < 0.7) return "Size: S";
    if (shirtScale < 0.9) return "Size: M";
    if (shirtScale < 1.1) return "Size: L";
    if (shirtScale < 1.3) return "Size: XL";
    return "Size: XXL";
}

function getFitRecommendation(score) {
    if (score >= 80) return "This size fits you perfectly!";
    if (score >= 60) return "Consider trying one size different";
    return "Try adjusting the scale or select a different size";
}

function resetAR() {
    shirtScale = 1.0;
    shirtX = 0;
    shirtY = 0;
    fitCheckResult = null;
    
    // Hide fit guide
    document.getElementById('fitGuide').style.display = 'none';
    
    showToast("AR Try-On reset", "info");
}

// ===== SHOP LOGIC =====
function renderShop() {
    const grid = document.getElementById('productGrid');
    let filteredProducts = [...products];
    
    // Apply filter
    if (currentFilter === 'new') {
        filteredProducts = products.filter(p => p.label === 'new');
    } else if (currentFilter === 'best') {
        filteredProducts = products.filter(p => p.label === 'best');
    }
    
    // Apply sorting
    filteredProducts = sortProductList(filteredProducts, currentSort);
    
    // Update product count
    document.getElementById('productCount').textContent = filteredProducts.length;
    
    // Render products
    grid.innerHTML = filteredProducts.map(p => {
        const isWished = wishlist.find(w => w.id === p.id);
        const finalPrice = p.salePrice || p.price;
        const discount = p.salePrice ? Math.round(((p.price - p.salePrice) / p.price) * 100) : 0;
        
        return `
        <div class="card fade-up">
            <div class="card-img-wrap">
                ${p.label ? `<span class="product-label ${p.label === 'sale' ? 'label-sale' : 'label-new'}">${p.label === 'sale' ? `-${discount}%` : p.label.toUpperCase()}</span>` : ''}
                <button class="wishlist-btn ${isWished ? 'active' : ''}" onclick="toggleWishlist(${p.id})" aria-label="${isWished ? 'Remove from wishlist' : 'Add to wishlist'}">
                    <i class="fa-${isWished ? 'solid' : 'regular'} fa-heart"></i>
                </button>
                <img src="${p.img}" class="card-img" alt="${p.name}" loading="lazy">
            </div>
            <div class="card-body">
                <div class="card-title">${p.name}</div>
                <div class="card-price">
                    ${CONFIG.currency}${finalPrice}
                    ${p.salePrice ? `<span class="old-price">${CONFIG.currency}${p.price}</span>` : ''}
                </div>
                <div class="stock-info mb-2" style="font-size:0.85rem; color:${p.stock > 5 ? 'var(--primary)' : p.stock > 0 ? 'var(--gold)' : '#ff4757'}">
                    ${p.stock > 5 ? 'In Stock' : p.stock > 0 ? `Only ${p.stock} left` : 'Out of Stock'}
                </div>
                <div class="size-row" id="size-${p.id}">
                    ${['S','M','L','XL','XXL'].map(s => 
                        `<div class="size-opt ${p.stock === 0 ? 'disabled' : ''}" 
                              onclick="${p.stock > 0 ? `selectSize(${p.id}, '${s}', this)` : ''}"
                              title="${p.stock === 0 ? 'Out of stock' : `Select size ${s}`}">
                            ${s}
                        </div>`
                    ).join('')}
                </div>
                <div style="display: flex; gap: 10px; margin-top: 10px;">
                    <button class="btn-add" onclick="addToCart(${p.id})" ${p.stock === 0 ? 'disabled' : ''} style="flex: 2;">
                        ${p.stock === 0 ? 'Out of Stock' : 'Add to Bag'}
                    </button>
                    <button class="btn btn-outline btn-small" onclick="selectARProduct(${p.id}); openARTryOn()" style="flex: 1;" title="Try it on virtually">
                        <i class="fa-solid fa-camera"></i>
                    </button>
                </div>
            </div>
        </div>`;
    }).join('');
}

function sortProductList(productList, sortType) {
    switch(sortType) {
        case 'price_asc':
            return [...productList].sort((a, b) => (a.salePrice || a.price) - (b.salePrice || b.price));
        case 'price_desc':
            return [...productList].sort((a, b) => (b.salePrice || b.price) - (a.salePrice || a.price));
        case 'name_asc':
            return [...productList].sort((a, b) => a.name.localeCompare(b.name));
        case 'name_desc':
            return [...productList].sort((a, b) => b.name.localeCompare(a.name));
        default:
            return productList;
    }
}

function sortProducts() {
    currentSort = document.getElementById('sortSelect').value;
    renderShop();
}

function filterProducts() {
    currentFilter = document.getElementById('filterSelect').value;
    renderShop();
}

function selectSize(pid, size, el) {
    const product = products.find(p => p.id === pid);
    if (product.stock === 0) return;
    
    selections[pid] = size;
    const parent = document.getElementById(`size-${pid}`);
    parent.querySelectorAll('.size-opt').forEach(b => b.classList.remove('selected'));
    el.classList.add('selected');
}

function addToCart(pid) {
    const size = selections[pid];
    if (!size) {
        showToast("Please select a size", "warning");
        return;
    }
    
    const product = products.find(p => p.id === pid);
    if (product.stock === 0) {
        showToast("Product is out of stock", "error");
        return;
    }
    
    const existingItem = cart.find(x => x.id === pid && x.size === size);
    
    if (existingItem) {
        if (existingItem.qty >= product.stock) {
            showToast(`Only ${product.stock} items available in stock`, "warning");
            return;
        }
        existingItem.qty++;
    } else {
        cart.push({
            ...product,
            size,
            qty: 1,
            finalPrice: product.salePrice || product.price
        });
    }
    
    saveCart();
    showToast("Added to Bag", "success");
    toggleCart();
}

// ===== CART MANAGEMENT =====
function saveCart() {
    localStorage.setItem('aose_cart', JSON.stringify(cart));
    updateCartUI();
}

function updateCartUI() {
    const cartCount = cart.reduce((total, item) => total + item.qty, 0);
    document.getElementById('cartCount').textContent = cartCount;
    document.getElementById('wishlistCount').textContent = wishlist.length;
    
    const subtotal = cart.reduce((total, item) => total + (item.finalPrice * item.qty), 0);
    const total = subtotal + CONFIG.shippingFee;
    
    document.getElementById('cartSubtotal').textContent = `${CONFIG.currency}${subtotal}`;
    document.getElementById('cartTotal').textContent = `${CONFIG.currency}${total}`;
    
    // Render cart items
    const cartItemsContainer = document.getElementById('cartItems');
    if (cart.length === 0) {
        cartItemsContainer.innerHTML = `
            <div class="empty-cart text-center">
                <i class="fa-solid fa-bag-shopping" style="font-size:3rem; color:#ddd; margin-bottom:20px;"></i>
                <p style="color:#999; margin-bottom:20px;">Your bag is empty</p>
                <button class="btn btn-gold" onclick="closeAll(); document.getElementById('shop').scrollIntoView({behavior: 'smooth'})">
                    Start Shopping
                </button>
            </div>`;
        return;
    }
    
    cartItemsContainer.innerHTML = cart.map((item, index) => `
        <div class="cart-item">
            <img src="${item.img}" class="cart-img" alt="${item.name}">
            <div class="cart-item-details">
                <div class="cart-item-title">${item.name}</div>
                <div class="cart-item-size">Size: ${item.size}</div>
                <div class="cart-item-price">${CONFIG.currency}${item.finalPrice} Ã— ${item.qty}</div>
                <div class="qty-box">
                    <button class="qty-btn" onclick="modQty(${index}, -1)" ${item.qty <= 1 ? 'disabled' : ''}>-</button>
                    <span class="qty-value">${item.qty}</span>
                    <button class="qty-btn" onclick="modQty(${index}, 1)" ${item.qty >= (item.stock || 10) ? 'disabled' : ''}>+</button>
                </div>
            </div>
            <button class="remove-item" onclick="removeFromCart(${index})" title="Remove item">
                <i class="fa-solid fa-trash"></i>
            </button>
        </div>
    `).join('');
}

function modQty(index, change) {
    const item = cart[index];
    const product = products.find(p => p.id === item.id);
    
    item.qty += change;
    
    if (item.qty <= 0) {
        cart.splice(index, 1);
    } else if (item.qty > (product.stock || 10)) {
        item.qty = product.stock || 10;
        showToast(`Maximum ${product.stock} items available`, "warning");
    }
    
    saveCart();
}

function removeFromCart(index) {
    if (confirm('Remove this item from cart?')) {
        cart.splice(index, 1);
        saveCart();
        showToast("Item removed from cart", "success");
    }
}

function clearCart() {
    if (cart.length === 0) return;
    
    if (confirm('Clear all items from your cart?')) {
        cart = [];
        saveCart();
        showToast("Cart cleared", "success");
    }
}

// ===== WISHLIST =====
function toggleWishlist(pid) {
    const product = products.find(p => p.id === pid);
    const index = wishlist.findIndex(x => x.id === pid);
    
    if (index > -1) {
        wishlist.splice(index, 1);
        showToast("Removed from Wishlist", "success");
    } else {
        wishlist.push(product);
        showToast("Added to Wishlist", "success");
    }
    
    localStorage.setItem('aose_wishlist', JSON.stringify(wishlist));
    renderShop();
    updateCartUI();
}

function openWishlist() {
    closeAll();
    document.getElementById('wishlistModal').classList.add('active');
    document.getElementById('overlay').classList.add('active');
    
    const wishlistContent = document.getElementById('wishlistContent');
    
    if (wishlist.length === 0) {
        wishlistContent.innerHTML = `
            <div class="empty-wishlist text-center">
                <i class="fa-regular fa-heart" style="font-size:3rem; color:#ddd; margin-bottom:20px;"></i>
                <p style="color:#999; margin-bottom:20px;">Your wishlist is empty</p>
                <button class="btn btn-gold" onclick="closeAll(); document.getElementById('shop').scrollIntoView({behavior: 'smooth'})">
                    Browse Products
                </button>
            </div>`;
        return;
    }
    
    wishlistContent.innerHTML = wishlist.map(product => {
        const finalPrice = product.salePrice || product.price;
        
        return `
        <div class="wishlist-item" style="display:flex; align-items:center; gap:15px; padding:15px; border-bottom:1px solid #eee; background:white; border-radius:var(--radius);">
            <img src="${product.img}" style="width:70px; height:90px; object-fit:cover; border-radius:var(--radius);">
            <div style="flex:1;">
                <div style="font-weight:600; margin-bottom:5px;">${product.name}</div>
                <div style="color:var(--gold); font-weight:700; margin-bottom:10px;">${CONFIG.currency}${finalPrice}</div>
                <div style="display:flex; gap:10px;">
                    <button onclick="addToCart(${product.id}); selectSize(${product.id}, 'M', this);" 
                            style="padding:8px 15px; background:var(--primary); color:white; border:none; border-radius:var(--radius); font-size:0.85rem; cursor:pointer;">
                        Add to Cart
                    </button>
                    <button onclick="toggleWishlist(${product.id})" 
                            style="padding:8px; background:#ffebee; color:#d32f2f; border:none; border-radius:var(--radius); cursor:pointer;">
                        <i class="fa-solid fa-trash"></i>
                    </button>
                </div>
            </div>
        </div>`;
    }).join('');
}

// ===== CHECKOUT & PAYMENT =====
function openCheckout() {
    if (cart.length === 0) {
        showToast("Cart is empty", "warning");
        return;
    }
    
    closeAll();
    document.getElementById('checkoutModal').classList.add('active');
    document.getElementById('overlay').classList.add('active');
    
    // Pre-fill user details if logged in
    if (user) {
        document.getElementById('cName').value = user.name;
        document.getElementById('cEmail').value = user.email;
        document.getElementById('cPhone').value = user.phone;
    }
    
    showStep(1);
}

function showStep(stepNumber) {
    for (let i = 1; i <= 3; i++) {
        document.getElementById(`step${i}`).style.display = i === stepNumber ? 'block' : 'none';
    }
}

function validateShipping() {
    const requiredFields = ['cName', 'cPhone', 'cEmail', 'cAddr', 'cCity', 'cState', 'cPincode'];
    let isValid = true;
    
    requiredFields.forEach(fieldId => {
        const field = document.getElementById(fieldId);
        if (!field.value.trim()) {
            field.style.borderColor = '#ff4757';
            isValid = false;
        } else {
            field.style.borderColor = '';
        }
    });
    
    if (!isValid) {
        showToast("Please fill all required fields", "error");
        return;
    }
    
    // Validate phone number
    const phone = document.getElementById('cPhone').value;
    if (!/^\d{10}$/.test(phone)) {
        showToast("Please enter a valid 10-digit phone number", "error");
        return;
    }
    
    // Validate pincode
    const pincode = document.getElementById('cPincode').value;
    if (!/^\d{6}$/.test(pincode)) {
        showToast("Please enter a valid 6-digit pincode", "error");
        return;
    }
    
    // Proceed to payment
    const total = cart.reduce((sum, item) => sum + (item.finalPrice * item.qty), 0);
    document.getElementById('payAmount').textContent = total;
    
    // Generate UPI QR Code
    const upiUrl = `upi://pay?pa=${CONFIG.upiId}&pn=${encodeURIComponent(CONFIG.storeName)}&am=${total}&cu=INR&tn=Payment for AOSE Order`;
    document.getElementById('qrcode').innerHTML = '';
    new QRCode(document.getElementById('qrcode'), {
        text: upiUrl,
        width: 180,
        height: 180,
        colorDark: '#0f3d2e',
        colorLight: '#ffffff',
        correctLevel: QRCode.CorrectLevel.H
    });
    
    document.getElementById('upiIdDisplay').textContent = CONFIG.upiId;
    showStep(2);
}

function selectPayment(method) {
    document.querySelectorAll('.payment-option').forEach(btn => btn.classList.remove('active'));
    event.target.closest('.payment-option').classList.add('active');
    
    // Show/hide UPI section
    document.getElementById('upiSection').style.display = method === 'upi' ? 'block' : 'none';
}

function backToShipping() {
    showStep(1);
}

function confirmOrder() {
    const orderId = 'AOSE-' + Date.now().toString().slice(-6);
    const shippingDetails = {
        name: document.getElementById('cName').value,
        phone: document.getElementById('cPhone').value,
        email: document.getElementById('cEmail').value,
        address: document.getElementById('cAddr').value,
        city: document.getElementById('cCity').value,
        state: document.getElementById('cState').value,
        pincode: document.getElementById('cPincode').value
    };
    
    const orderItems = cart.map(item => ({
        id: item.id,
        name: item.name,
        size: item.size,
        qty: item.qty,
        price: item.finalPrice,
        total: item.finalPrice * item.qty
    }));
    
    const total = orderItems.reduce((sum, item) => sum + item.total, 0);
    
    currentOrder = {
        id: orderId,
        customer: shippingDetails.name,
        phone: shippingDetails.phone,
        email: shippingDetails.email,
        shipping: shippingDetails,
        items: orderItems,
        total: total,
        date: new Date().toLocaleString(),
        status: 'Placed',
        paymentMethod: 'UPI',
        paymentStatus: 'Pending'
    };
    
    // Save order
    orders.push(currentOrder);
    localStorage.setItem('aose_orders', JSON.stringify(orders));
    
    // Update user orders if logged in
    if (user) {
        const userIndex = users.findIndex(u => u.email === user.email);
        if (userIndex > -1) {
            users[userIndex].orders = users[userIndex].orders || [];
            users[userIndex].orders.push(orderId);
            localStorage.setItem('aose_users', JSON.stringify(users));
        }
    }
    
    // Clear cart
    cart = [];
    saveCart();
    
    // Update UI
    document.getElementById('finalId').textContent = orderId;
    showStep(3);
    
    // Show success message
    showToast("Order placed successfully!", "success");
}

// ===== AUTHENTICATION =====
function toggleAuth() {
    closeAll();
    document.getElementById('authModal').classList.add('active');
    document.getElementById('overlay').classList.add('active');
    
    if (user) {
        document.getElementById('loginForm').style.display = 'none';
        document.getElementById('profileView').style.display = 'block';
        document.getElementById('authTitle').textContent = "My Profile";
        document.getElementById('profileName').textContent = user.name;
        renderOrderHistory();
    } else {
        document.getElementById('loginForm').style.display = 'block';
        document.getElementById('profileView').style.display = 'none';
        document.getElementById('authTitle').textContent = "Sign In";
    }
}

function login() {
    const name = document.getElementById('uName').value.trim();
    const email = document.getElementById('uEmail').value.trim();
    const phone = document.getElementById('uPhone').value.trim();
    
    if (!name || !email || !phone) {
        showToast("Please fill all fields", "error");
        return;
    }
    
    if (!/^\S+@\S+\.\S+$/.test(email)) {
        showToast("Please enter a valid email", "error");
        return;
    }
    
    if (!/^\d{10}$/.test(phone)) {
        showToast("Please enter a valid 10-digit phone number", "error");
        return;
    }
    
    // Check if user exists
    let userIndex = users.findIndex(u => u.email === email);
    
    if (userIndex === -1) {
        // Create new user
        users.push({
            name,
            email,
            phone,
            orders: []
        });
        userIndex = users.length - 1;
    } else {
        // Update existing user
        users[userIndex].name = name;
        users[userIndex].phone = phone;
    }
    
    user = users[userIndex];
    localStorage.setItem('aose_user', JSON.stringify(user));
    localStorage.setItem('aose_users', JSON.stringify(users));
    
    updateUserUI();
    toggleAuth();
    showToast(`Welcome ${name}!`, "success");
}

function logout() {
    if (confirm('Are you sure you want to sign out?')) {
        user = null;
        localStorage.removeItem('aose_user');
        updateUserUI();
        toggleAuth();
        showToast("Signed out successfully", "success");
    }
}

function updateUserUI() {
    const userLabel = document.getElementById('userLabel');
    if (user) {
        userLabel.textContent = user.name.split(' ')[0];
        userLabel.style.fontSize = '12px';
        userLabel.style.fontWeight = '600';
        userLabel.style.marginLeft = '5px';
    } else {
        userLabel.textContent = '';
    }
}

function renderOrderHistory() {
    const orderHistory = document.getElementById('orderHistory');
    const userOrders = orders.filter(o => o.email === user.email);
    
    if (userOrders.length === 0) {
        orderHistory.innerHTML = `
            <div class="empty-orders text-center" style="padding:30px; color:#999;">
                <i class="fa-solid fa-box-open" style="font-size:2.5rem; margin-bottom:15px; opacity:0.5;"></i>
                <p>No orders yet</p>
                <button class="btn btn-gold btn-small" onclick="closeAll(); document.getElementById('shop').scrollIntoView({behavior: 'smooth'})" style="margin-top:15px;">
                    Start Shopping
                </button>
            </div>`;
        return;
    }
    
    orderHistory.innerHTML = userOrders.map(order => `
        <div class="order-card" style="background:white; border-radius:var(--radius); padding:15px; margin-bottom:15px; box-shadow:var(--shadow-soft);">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
                <strong>${order.id}</strong>
                <span class="status-badge ${getStatusClass(order.status)}">${order.status}</span>
            </div>
            <div style="color:#666; font-size:0.9rem; margin-bottom:10px;">
                ${order.date} | ${order.items.length} item${order.items.length > 1 ? 's' : ''}
            </div>
            <div style="color:var(--primary); font-weight:700; text-align:right;">
                ${CONFIG.currency}${order.total}
            </div>
        </div>
    `).join('');
}

function getStatusClass(status) {
    switch(status.toLowerCase()) {
        case 'placed': return 'status-placed';
        case 'confirmed': return 'status-confirmed';
        case 'shipped': return 'status-shipped';
        case 'delivered': return 'status-delivered';
        case 'cancelled': return 'status-cancelled';
        default: return '';
    }
}

// ===== INVOICE GENERATION =====
function downloadInvoice() {
    if (!currentOrder) return;
    
    const invoice = document.getElementById('invoice');
    
    // Populate invoice data
    document.getElementById('invId').textContent = currentOrder.id;
    document.getElementById('invName').textContent = currentOrder.customer;
    document.getElementById('invPhone').textContent = currentOrder.phone;
    document.getElementById('invEmail').textContent = currentOrder.email;
    document.getElementById('invAddress').textContent = 
        `${currentOrder.shipping.address}, ${currentOrder.shipping.city}, ${currentOrder.shipping.state} - ${currentOrder.shipping.pincode}`;
    document.getElementById('invDate').textContent = new Date().toLocaleDateString('en-IN', {
        day: '2-digit',
        month: 'long',
        year: 'numeric'
    });
    document.getElementById('invOrderDate').textContent = currentOrder.date;
    document.getElementById('invStatus').textContent = currentOrder.status;
    
    // Populate items
    const invItems = document.getElementById('invItems');
    const subtotal = currentOrder.items.reduce((sum, item) => sum + item.total, 0);
    
    invItems.innerHTML = currentOrder.items.map(item => `
        <tr>
            <td style="padding:12px;">${item.name}</td>
            <td style="padding:12px; text-align:center;">${item.size}</td>
            <td style="padding:12px; text-align:center;">${item.qty}</td>
            <td style="padding:12px; text-align:right;">${CONFIG.currency}${item.price}</td>
            <td style="padding:12px; text-align:right;">${CONFIG.currency}${item.total}</td>
        </tr>
    `).join('');
    
    document.getElementById('invSubtotal').textContent = subtotal;
    document.getElementById('invTotal').textContent = currentOrder.total;
    
    // Generate PDF
    invoice.style.display = 'block';
    const options = {
        margin: 10,
        filename: `Invoice_${currentOrder.id}.pdf`,
        image: { type: 'jpeg', quality: 0.98 },
        html2canvas: { scale: 2 },
        jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
    };
    
    html2pdf().set(options).from(invoice).save().then(() => {
        invoice.style.display = 'none';
        showToast("Invoice downloaded successfully", "success");
    });
}

// ===== ADMIN PANEL =====
function openAdmin() {
    closeAll();
    document.getElementById('adminModal').classList.add('active');
    document.getElementById('overlay').classList.add('active');
    document.getElementById('adminLogin').style.display = 'block';
    document.getElementById('adminDash').style.display = 'none';
    document.getElementById('admPass').value = '';
}

function checkAdmin() {
    const password = document.getElementById('admPass').value;
    
    if (password === CONFIG.adminPass) {
        document.getElementById('adminLogin').style.display = 'none';
        document.getElementById('adminDash').style.display = 'block';
        renderAdminDashboard();
    } else {
        showToast("Incorrect password", "error");
    }
}

function renderAdminDashboard() {
    // Update stats
    document.getElementById('totalOrders').textContent = orders.length;
    document.getElementById('totalRevenue').textContent = `${CONFIG.currency}${orders.reduce((sum, order) => sum + order.total, 0)}`;
    document.getElementById('pendingOrders').textContent = orders.filter(o => o.status === 'Placed').length;
    document.getElementById('totalUsers').textContent = users.length;
    
    // Render orders table
    const tableBody = document.getElementById('adminTableBody');
    tableBody.innerHTML = orders.map(order => `
        <tr>
            <td><strong>${order.id}</strong></td>
            <td>
                <div>${order.customer}</div>
                <small style="color:#666;">${order.phone}</small>
            </td>
            <td>${order.items.length} items</td>
            <td>${CONFIG.currency}${order.total}</td>
            <td>
                <select class="status-select" data-order-id="${order.id}" onchange="updateOrderStatus('${order.id}', this.value)" 
                        style="padding:5px; border-radius:var(--radius); border:1px solid #ddd;">
                    <option value="Placed" ${order.status === 'Placed' ? 'selected' : ''}>Placed</option>
                    <option value="Confirmed" ${order.status === 'Confirmed' ? 'selected' : ''}>Confirmed</option>
                    <option value="Shipped" ${order.status === 'Shipped' ? 'selected' : ''}>Shipped</option>
                    <option value="Delivered" ${order.status === 'Delivered' ? 'selected' : ''}>Delivered</option>
                    <option value="Cancelled" ${order.status === 'Cancelled' ? 'selected' : ''}>Cancelled</option>
                </select>
            </td>
            <td>${order.date.split(',')[0]}</td>
            <td>
                <button class="action-btn btn-view" onclick="viewOrderDetails('${order.id}')" title="View Details">
                    <i class="fa-solid fa-eye"></i>
                </button>
                <button class="action-btn btn-delete" onclick="deleteOrder('${order.id}')" title="Delete Order">
                    <i class="fa-solid fa-trash"></i>
                </button>
            </td>
        </tr>
    `).join('');
}

function updateOrderStatus(orderId, newStatus) {
    const orderIndex = orders.findIndex(o => o.id === orderId);
    if (orderIndex > -1) {
        orders[orderIndex].status = newStatus;
        localStorage.setItem('aose_orders', JSON.stringify(orders));
        showToast(`Order ${orderId} updated to ${newStatus}`, "success");
        renderAdminDashboard();
    }
}

function viewOrderDetails(orderId) {
    const order = orders.find(o => o.id === orderId);
    if (!order) return;
    
    let details = `Order ID: ${order.id}\n`;
    details += `Customer: ${order.customer}\n`;
    details += `Phone: ${order.phone}\n`;
    details += `Email: ${order.email}\n`;
    details += `Date: ${order.date}\n`;
    details += `Status: ${order.status}\n`;
    details += `Total: ${CONFIG.currency}${order.total}\n\n`;
    details += `Items:\n`;
    order.items.forEach(item => {
        details += `- ${item.name} (Size: ${item.size}, Qty: ${item.qty}) - ${CONFIG.currency}${item.total}\n`;
    });
    
    alert(details);
}

function deleteOrder(orderId) {
    if (confirm(`Delete order ${orderId}? This action cannot be undone.`)) {
        const orderIndex = orders.findIndex(o => o.id === orderId);
        if (orderIndex > -1) {
            orders.splice(orderIndex, 1);
            localStorage.setItem('aose_orders', JSON.stringify(orders));
            showToast(`Order ${orderId} deleted`, "success");
            renderAdminDashboard();
        }
    }
}

function exportExcel() {
    if (orders.length === 0) {
        showToast("No orders to export", "warning");
        return;
    }
    
    const worksheetData = orders.map(order => ({
        'Order ID': order.id,
        'Customer': order.customer,
        'Phone': order.phone,
        'Email': order.email,
        'Items': order.items.length,
        'Total': order.total,
        'Status': order.status,
        'Date': order.date,
        'Payment Method': order.paymentMethod,
        'Payment Status': order.paymentStatus
    }));
    
    const ws = XLSX.utils.json_to_sheet(worksheetData);
    const wb = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(wb, ws, "Orders");
    XLSX.writeFile(wb, `AOSE_Orders_${new Date().toISOString().split('T')[0]}.xlsx`);
    showToast("Excel file exported successfully", "success");
}

function resetDB() {
    if (confirm("WARNING: This will reset ALL data including orders, users, cart, and wishlist. Are you sure?")) {
        if (prompt("Type 'RESET' to confirm:") === 'RESET') {
            localStorage.clear();
            location.reload();
        }
    }
}

function refreshOrders() {
    renderAdminDashboard();
    showToast("Orders refreshed", "success");
}

// ===== ORDER TRACKING =====
function openTrack() {
    closeAll();
    document.getElementById('trackModal').classList.add('active');
    document.getElementById('overlay').classList.add('active');
    document.getElementById('trackRes').innerHTML = '';
}

function doTrack() {
    const orderId = document.getElementById('trackInput').value.trim().toUpperCase();
    const order = orders.find(o => o.id === orderId);
    const trackRes = document.getElementById('trackRes');
    
    if (!order) {
        trackRes.innerHTML = `
            <div style="color:#ff4757; padding:15px; background:#ffebee; border-radius:var(--radius);">
                <i class="fa-solid fa-circle-exclamation"></i> Order not found
            </div>`;
        return;
    }
    
    // Define status steps
    const statusSteps = [
        { status: 'Placed', label: 'Order Placed', icon: 'fa-clipboard-check' },
        { status: 'Confirmed', label: 'Order Confirmed', icon: 'fa-check-circle' },
        { status: 'Shipped', label: 'Shipped', icon: 'fa-truck' },
        { status: 'Delivered', label: 'Delivered', icon: 'fa-box-open' }
    ];
    
    // Find current status index
    const currentStatusIndex = statusSteps.findIndex(step => step.status === order.status);
    
    trackRes.innerHTML = `
        <div style="background:white; border-radius:var(--radius); padding:20px; box-shadow:var(--shadow-soft);">
            <h4 style="color:var(--primary); margin-bottom:15px;">Order ${order.id}</h4>
            
            <div style="display:flex; justify-content:space-between; margin-bottom:20px; position:relative;">
                <div style="position:absolute; top:15px; left:0; right:0; height:2px; background:#eee; z-index:1;"></div>
                ${statusSteps.map((step, index) => `
                    <div style="text-align:center; position:relative; z-index:2;">
                        <div style="width:30px; height:30px; border-radius:50%; background:${index <= currentStatusIndex ? 'var(--primary)' : '#eee'}; 
                             color:${index <= currentStatusIndex ? 'white' : '#999'}; display:flex; align-items:center; justify-content:center; margin:0 auto 10px;">
                            <i class="fa-solid ${step.icon}"></i>
                        </div>
                        <div style="font-size:0.8rem; color:${index <= currentStatusIndex ? 'var(--primary)' : '#999'};">${step.label}</div>
                    </div>
                `).join('')}
            </div>
            
            <div style="background:#f8f9fa; padding:15px; border-radius:var(--radius); margin-top:20px;">
                <p style="margin-bottom:5px;"><strong>Status:</strong> <span class="status-badge ${getStatusClass(order.status)}">${order.status}</span></p>
                <p style="margin-bottom:5px;"><strong>Date:</strong> ${order.date}</p>
                <p style="margin-bottom:5px;"><strong>Items:</strong> ${order.items.length}</p>
                <p style="margin-bottom:5px;"><strong>Total:</strong> ${CONFIG.currency}${order.total}</p>
                ${order.shipping ? `<p><strong>Shipping to:</strong> ${order.shipping.address}, ${order.shipping.city}</p>` : ''}
            </div>
        </div>`;
}

// ===== UI UTILITIES =====
function toggleCart() {
    const drawer = document.getElementById('cartDrawer');
    const overlay = document.getElementById('overlay');
    
    if (drawer.classList.contains('active')) {
        drawer.classList.remove('active');
        overlay.classList.remove('active');
    } else {
        drawer.classList.add('active');
        overlay.classList.add('active');
    }
}

function closeAll() {
    document.querySelectorAll('.modal, .drawer, .overlay').forEach(element => {
        element.classList.remove('active');
    });
}

function showToast(message, type = 'success') {
    const toast = document.getElementById('toast');
    const toastIcon = toast.querySelector('.toast-icon');
    const toastMessage = toast.querySelector('.toast-message');
    
    // Set message and icon based on type
    toastMessage.textContent = message;
    toast.className = 'toast'; // Reset classes
    
    switch(type) {
        case 'success':
            toast.classList.add('success');
            toastIcon.className = 'toast-icon fa-solid fa-check';
            break;
        case 'error':
            toast.classList.add('error');
            toastIcon.className = 'toast-icon fa-solid fa-circle-exclamation';
            break;
        case 'warning':
            toast.classList.add('warning');
            toastIcon.className = 'toast-icon fa-solid fa-triangle-exclamation';
            break;
        default:
            toastIcon.className = 'toast-icon fa-solid fa-info-circle';
    }
    
    // Show toast
    toast.classList.add('show');
    
    // Auto-hide after 3 seconds
    setTimeout(() => {
        toast.classList.remove('show');
    }, 3000);
}

// Cleanup function
window.addEventListener('beforeunload', () => {
    if (cameraStream) {
        cameraStream.getTracks().forEach(track => track.stop());
    }
    if (animationId) {
        cancelAnimationFrame(animationId);
    }
});
</script>
</body>
</html>
